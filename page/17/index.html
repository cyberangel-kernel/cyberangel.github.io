<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Cyberangel-blog</title><meta name="author" content="Cyberangel"><meta name="copyright" content="Cyberangel"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="referrer" content="no-referrer"><meta property="og:type" content="website">
<meta property="og:title" content="Cyberangel-blog">
<meta property="og:url" content="https://cyberangel.cn/page/17/index.html">
<meta property="og:site_name" content="Cyberangel-blog">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://cyberangel.cn/img/1.jpg">
<meta property="article:author" content="Cyberangel">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://cyberangel.cn/img/1.jpg"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://cyberangel.cn/page/17/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    },
    fancybox: {
      js: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js',
      css: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isanchor: true
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Cyberangel-blog',
  isPost: false,
  isHome: true,
  isHighlightShrink: false,
  isToc: false,
  postUpdate: '2021-07-04 21:42:04'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const fontSizeVal = saveToLocal.get('global-font-size')
    if (fontSizeVal !== undefined) {
      document.documentElement.style.setProperty('--global-font-size', fontSizeVal + 'px')
    }
    
    const detectApple = () => {
      if (GLOBAL_CONFIG_SITE.isHome && /iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 5.4.0"><link rel="alternate" href="/atom.xml" title="Cyberangel-blog" type="application/atom+xml">
</head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/1.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">文章</div><div class="length-num">317</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="page" id="body-wrap"><header class="full_page" id="page-header" style="background-image: url('https://uploadstatic.mihoyo.com/contentweb/20210203/2021020310200944529.png')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">Cyberangel-blog</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="site-info"><h1 id="site-title">Cyberangel-blog</h1><div id="site-subtitle"><span id="subtitle"></span></div><div id="site_social_icons"><a class="social-icon" href="https://github.com/cyberangel-kernel" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:995675318@qq.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a><a class="social-icon" href="https://www.yuque.com/cyberangel/" target="_blank" title="语雀"><i class="fab fa-alipay"></i></a></div></div><div id="scroll-down"><i class="fas fa-angle-down scroll-down-effects"></i></div></header><main class="layout" id="content-inner"><div class="recent-posts" id="recent-posts"><div class="recent-post-item"><div class="post_cover left_radius"><a href="/2020/03/24/%E8%B7%AF%E7%94%B1%E5%99%A8%E9%80%86%E5%90%91%E5%88%86%E6%9E%90------firmware-mod-kit%E5%B7%A5%E5%85%B7%E5%AE%89%E8%A3%85%E5%92%8C%E4%BD%BF%E7%94%A8%E8%AF%B4%E6%98%8E/" title="路由器逆向分析------firmware-mod-kit工具安装和使用说明">     <img class="post_bg" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="路由器逆向分析------firmware-mod-kit工具安装和使用说明"></a></div><div class="recent-post-info"><a class="article-title" href="/2020/03/24/%E8%B7%AF%E7%94%B1%E5%99%A8%E9%80%86%E5%90%91%E5%88%86%E6%9E%90------firmware-mod-kit%E5%B7%A5%E5%85%B7%E5%AE%89%E8%A3%85%E5%92%8C%E4%BD%BF%E7%94%A8%E8%AF%B4%E6%98%8E/" title="路由器逆向分析------firmware-mod-kit工具安装和使用说明">路由器逆向分析------firmware-mod-kit工具安装和使用说明</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2020-03-24T03:05:45.000Z" title="发表于 2020-03-24 11:05:45">2020-03-24</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-comments"></i><a href="https://cyberangel.cn/2020/03/24/%E8%B7%AF%E7%94%B1%E5%99%A8%E9%80%86%E5%90%91%E5%88%86%E6%9E%90------firmware-mod-kit%E5%B7%A5%E5%85%B7%E5%AE%89%E8%A3%85%E5%92%8C%E4%BD%BF%E7%94%A8%E8%AF%B4%E6%98%8E/#disqus_thread"></a><span class="article-meta-label"> 条评论</span></span></div><div class="content">本文博客地址：http://blog.csdn.net/qq1084283172/article/details/68061957
一、firmware-mod-kit 工具的安装**firmware-mod-kit 工具的功能和 binwalk 工具的类似，其实 firmware-mod-kit 工具在功能上有调用 binwalk 工具提供的功能以及其他的固件解包工具的整合。下载 firmware-mod-kit 工具的源码进入到 src 目录下就能够看到 firmware-mod-kit 工具整合了那些固件提取和文件系统解压的工具。firmware-mod-kit 工具的功能有固件文件的解包和打包、固件提取文件系统的解压和压缩、DD-WRT Web Pages 的修改等，在每个整合的固件分析工具的源码文件夹里都有相关的使用说明。

1.在 ubuntu 系统上安装 firmware-mod-kit 工具之前需要先安装需要的依赖库文件。具体可以参考 firmware-mod-kit 工具的官方说明文档：https://code.google.com/archive/p/firmwar ...</div></div></div><div class="recent-post-item"><div class="post_cover right_radius"><a href="/2020/03/17/Delphi%E5%8F%AF%E6%89%A7%E8%A1%8C%E6%96%87%E4%BB%B6%EF%BC%88exe%EF%BC%89%E8%84%B1%E5%A3%B3/" title="Delphi可执行文件（exe）脱壳">     <img class="post_bg" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Delphi可执行文件（exe）脱壳"></a></div><div class="recent-post-info"><a class="article-title" href="/2020/03/17/Delphi%E5%8F%AF%E6%89%A7%E8%A1%8C%E6%96%87%E4%BB%B6%EF%BC%88exe%EF%BC%89%E8%84%B1%E5%A3%B3/" title="Delphi可执行文件（exe）脱壳">Delphi可执行文件（exe）脱壳</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2020-03-17T07:09:27.000Z" title="发表于 2020-03-17 15:09:27">2020-03-17</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-comments"></i><a href="https://cyberangel.cn/2020/03/17/Delphi%E5%8F%AF%E6%89%A7%E8%A1%8C%E6%96%87%E4%BB%B6%EF%BC%88exe%EF%BC%89%E8%84%B1%E5%A3%B3/#disqus_thread"></a><span class="article-meta-label"> 条评论</span></span></div><div class="content">注：此文章摘选并略微改动自 Cyberangel 的“熊猫烧香病毒样本分析（1）：setup.exe”，如有错误请指正。
1、查壳运行吾爱破解工具包中的 PEID 和 Exeinfo PE，将文件分别载入，结果如下：提示有 FSG v2.0 的壳，并且在 Detect It Easy 中显示样本是由 Delphi 编写的
2、手动脱壳将 exe 文件拖入到 OD 中，往下拖动鼠标，发现代码不多，因此使用单步法脱壳.当 OD 执行到地址 4001D1 处，可以看到有特殊的跳转。按 F8 单步步过并按 Ctrl+A 进行强制分析后，向下拉动窗口可以看到病毒样本的主函数（请结合 IDA 分析），那么地址 0040D278 应该就是样本的 OEP。在 0040D278 处，Dump 此处内存：OD-&gt;插件-&gt;OllyDump-&gt;脱壳在当前调试的进程，设置选项如下图：确定，另存为 1.exe，尝试运行一下，出现错误：报错 0xC0000005.内存访问异常,应该是 FSG 壳对导入地址表做了处理,导致我们 dump 下来的文件无法正常运行，那么接下来换一种方式进行 dump。确 ...</div></div></div><div class="recent-post-item"><div class="post_cover left_radius"><a href="/2020/03/04/%E7%86%8A%E7%8C%AB%E7%83%A7%E9%A6%99%E6%A0%B7%E6%9C%AC%E5%88%86%E6%9E%90%EF%BC%881%EF%BC%89%EF%BC%9Asetup.exe/" title="熊猫烧香样本分析（1）：setup.exe">     <img class="post_bg" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="熊猫烧香样本分析（1）：setup.exe"></a></div><div class="recent-post-info"><a class="article-title" href="/2020/03/04/%E7%86%8A%E7%8C%AB%E7%83%A7%E9%A6%99%E6%A0%B7%E6%9C%AC%E5%88%86%E6%9E%90%EF%BC%881%EF%BC%89%EF%BC%9Asetup.exe/" title="熊猫烧香样本分析（1）：setup.exe">熊猫烧香样本分析（1）：setup.exe</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2020-03-04T03:04:07.000Z" title="发表于 2020-03-04 11:04:07">2020-03-04</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-comments"></i><a href="https://cyberangel.cn/2020/03/04/%E7%86%8A%E7%8C%AB%E7%83%A7%E9%A6%99%E6%A0%B7%E6%9C%AC%E5%88%86%E6%9E%90%EF%BC%881%EF%BC%89%EF%BC%9Asetup.exe/#disqus_thread"></a><span class="article-meta-label"> 条评论</span></span></div><div class="content">一、准备工作首先我们需要准备： 1.熊猫烧香病毒样本（信息如下）文件： C:\Documents and Settings\Administrator\桌面\setup.exe大小： 30, 001 字节修改时间：2007-01-17 12:18:40MD5： 512301C535C88255C9A252FDF70B7A03SHA1： CA3A1070CFF311C0BA40AB60A8FE3266CFEFE870CRC32：E334747C

注意：后三条数据为校验值，相当于病毒的指纹

2.一个 VMware-&gt;Windows XP 虚拟机 3.吾爱工具破解包4.IDA Pro5.OD6.PE View说说我为什么选用的虚拟机为 Windows XP 而不是 Windows 7：

在《逆向工程核心原理》的第 41 章 ASLR 写到：ASLR（Address Space Layout Randomization,地址空间布局随机化）是一种针对缓冲区溢出的安全保护技术，微软从 Windows Vista 开始采用该技术……借助 ASLR 技术，PE 文件每次加载到内存的起始地 ...</div></div></div><div class="recent-post-item"><div class="post_cover right_radius"><a href="/2020/02/19/%E7%AC%AC25%E7%AB%A0%20%E9%80%9A%E8%BF%87%E4%BF%AE%E6%94%B9PE%E5%8A%A0%E8%BD%BDDLL/" title="第25章 通过修改PE加载DLL">     <img class="post_bg" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="第25章 通过修改PE加载DLL"></a></div><div class="recent-post-info"><a class="article-title" href="/2020/02/19/%E7%AC%AC25%E7%AB%A0%20%E9%80%9A%E8%BF%87%E4%BF%AE%E6%94%B9PE%E5%8A%A0%E8%BD%BDDLL/" title="第25章 通过修改PE加载DLL">第25章 通过修改PE加载DLL</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2020-02-19T07:48:27.000Z" title="发表于 2020-02-19 15:48:27">2020-02-19</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-comments"></i><a href="https://cyberangel.cn/2020/02/19/%E7%AC%AC25%E7%AB%A0%20%E9%80%9A%E8%BF%87%E4%BF%AE%E6%94%B9PE%E5%8A%A0%E8%BD%BDDLL/#disqus_thread"></a><span class="article-meta-label"> 条评论</span></span></div><div class="content">除了前面讲过的 DLL 动态注入技术外，还可以采用“手工修改可执行文件”的方式加载用户指定的 DLL 文件，本章将向各位介绍这种方法。学习这种技术前，首先要掌握有关 PE 文件格式的知识。前面我们学过向“运行中的进程”强制注入指定 DLL 文件的方法。下面我们将换用另外一种方法，通过“直接修改目标程序的可执行文件”，使其运行时强制加载指定的 DLL 文件。这种方法只要应用过一次后（不需要另外的注入操作），每当进程开始运行时就会自动加载指定的 DLL 文件。其实，这是一种破解的方法。
25.1 练习文件本节将做个简单练习以帮助大家更好地理解要学习的内容。我们的目标是，直接修改 TextView.exe 文件，使其在运行时自动加载 myhack3.dll 文件（这需要各位事先掌握修改 PE 文件头的相关知识与技术）。
25.1.1 TextView.exeTextView.exe 是一个非常简单的文本查看程序，只要用鼠标将要查看的文本文件（myhack3.cpp）拖动（Drop）到其中，即可通过它查看文本文件的内容，如图 25-1 所示。各位可将任意一个文本文件拖入其中测试。接下来，使用  ...</div></div></div><div class="recent-post-item"><div class="post_cover left_radius"><a href="/2020/02/19/%E7%AC%AC24%E7%AB%A0%20DLL%E5%8D%B8%E8%BD%BD/" title="第24章 DLL卸载">     <img class="post_bg" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="第24章 DLL卸载"></a></div><div class="recent-post-info"><a class="article-title" href="/2020/02/19/%E7%AC%AC24%E7%AB%A0%20DLL%E5%8D%B8%E8%BD%BD/" title="第24章 DLL卸载">第24章 DLL卸载</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2020-02-19T07:12:43.000Z" title="发表于 2020-02-19 15:12:43">2020-02-19</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-comments"></i><a href="https://cyberangel.cn/2020/02/19/%E7%AC%AC24%E7%AB%A0%20DLL%E5%8D%B8%E8%BD%BD/#disqus_thread"></a><span class="article-meta-label"> 条评论</span></span></div><div class="content">DLL 卸载（DLLEjection)是将强制插入进程的 DLL 弹出的一种技术，其基本工作原理与使用 CreateRemoteThreadAPI 进行 DLL 注入的原理类似。
24.1DLL 卸载的工作原理前面我们学习过使用 CreateRemote Thread()API 进行 DLL 注入的工作原理，概括如下：

驱使目标进程调用 LoadLibrary()API

同样，DLL 卸载工作原理也非常简单：

驱使目标进程调用 FreeLibrary()API

也就是说，将 FreeLibrary()API 的地址传递给 CreateRemote Thread()的 IpStartAddress 参数，并把要卸载的 DLL 的句柄传递给 IpParameter 参数。提示——————————————————————————————————————每个 Windows 内核对象（KernelObject)都拥有一个引用计数（Reference Count)，代表对象被使用的次数。调用 10 次LoadLibrary（“a.dll”），a.dll 的引用计数就变为 10，卸载 a. ...</div></div></div><div class="recent-post-item"><div class="post_cover right_radius"><a href="/2020/02/13/%E7%AC%AC23%E7%AB%A0%20DLL%E6%B3%A8%E5%85%A5/" title="第23章 DLL注入">     <img class="post_bg" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="第23章 DLL注入"></a></div><div class="recent-post-info"><a class="article-title" href="/2020/02/13/%E7%AC%AC23%E7%AB%A0%20DLL%E6%B3%A8%E5%85%A5/" title="第23章 DLL注入">第23章 DLL注入</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2020-02-13T07:32:43.000Z" title="发表于 2020-02-13 15:32:43">2020-02-13</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-comments"></i><a href="https://cyberangel.cn/2020/02/13/%E7%AC%AC23%E7%AB%A0%20DLL%E6%B3%A8%E5%85%A5/#disqus_thread"></a><span class="article-meta-label"> 条评论</span></span></div><div class="content">DLL 注入（DLL Injection)是渗透其他进程的最简单有效的方法，本章将详细讲解 DLL 注入的有关内容。借助 DLL 注入技术，可以钩取 API、改进程序、修复 Bug 等。
23.1 DLL 注入DLL 注入指的是向运行中的其他进程强制插入特定的 DLL 文件。从技术细节来说，DLL 注入命令其他进程自行调用 LoadLibrary）API，加载（Loading)用户指定的 DLL 文件。DLL 注入与一般 DLL 加载的区别在于，加载的目标进程是其自身或其他进程。图 23-1 描述了 DLL 注入的概念。从图 23-1 中可以看到，myhack.dll 已被强制插入 notepad 进程（本来 notepad 并不会加载 myhack.dll）。加载到 notepad.exe 进程中的 myhack.dll 与已经加载到 notepad.exe 进程中的 DLL（kernel32.dll、user32.dll)一样，拥有访问 notepad.exe 进程内存的（正当的）权限，这样用户就可以做任何想做的事了（比如：向 notepad 添加通信功能以实现 Messenger ...</div></div></div><div class="recent-post-item"><div class="post_cover left_radius"><a href="/2020/02/13/%E7%AC%AC22%E7%AB%A0%E6%81%B6%E6%84%8F%E9%94%AE%E7%9B%98%E8%AE%B0%E5%BD%95%E5%99%A8/" title="第22章恶意键盘记录器">     <img class="post_bg" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="第22章恶意键盘记录器"></a></div><div class="recent-post-info"><a class="article-title" href="/2020/02/13/%E7%AC%AC22%E7%AB%A0%E6%81%B6%E6%84%8F%E9%94%AE%E7%9B%98%E8%AE%B0%E5%BD%95%E5%99%A8/" title="第22章恶意键盘记录器">第22章恶意键盘记录器</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2020-02-13T07:14:14.000Z" title="发表于 2020-02-13 15:14:14">2020-02-13</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-comments"></i><a href="https://cyberangel.cn/2020/02/13/%E7%AC%AC22%E7%AB%A0%E6%81%B6%E6%84%8F%E9%94%AE%E7%9B%98%E8%AE%B0%E5%BD%95%E5%99%A8/#disqus_thread"></a><span class="article-meta-label"> 条评论</span></span></div><div class="content">不能说（经用户同意）应用在管理中的键盘记录器（Key Logger)一定是坏的，问题是那些在用户不知情的情况下、出于恶意运行的键盘记录器。本章将分析出现这种恶意键盘记录器的原因。
22.1 恶意键盘记录器的目标就是“金钱”。键盘记录器的基本功能是记录并保存用户在键盘上输入的信息,然后将这些信息转移到指定地点。信息化社会中,“信息就是金钱”。那么,如何利用键盘记录器赚钱呢?下面先看几个示例。
22.1.1 在线游戏现在,网吧随处可见,黑客随便去一个网吧,偷偷在一台电脑上安装好键盘记录器后离开。之后会有人用这台安装了键盘记录器的电脑玩在线游戏,用户使用这台电脑时,键盘记录器会偷偷记录下游戏账号(ID、 Password),并通过邮件发送给黑客。黑客通过这些游戏账号登录在线游戏,可以把原玩家的游戏币与装备换成现金。玩过在线游戏的朋友应该对这种用游戏币和装备换钱的交易非常清楚(游戏装备的年交易额是普通人无法想象的)
22.1.2 网上银行那不玩在线游戏的人是不是就不会受到键盘记录器的侵害了呢？与每个人都息息相关的就是网上银行。如果网上银行的账户信息（ID、Password、账号）被盗该怎么办呢 ...</div></div></div><div class="recent-post-item"><div class="post_cover right_radius"><a href="/2020/02/13/%E7%AC%AC21%E7%AB%A0%20Windows%E6%B6%88%E6%81%AF%E9%92%A9%E5%8F%96/" title="第21章 Windows消息钩取">     <img class="post_bg" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="第21章 Windows消息钩取"></a></div><div class="recent-post-info"><a class="article-title" href="/2020/02/13/%E7%AC%AC21%E7%AB%A0%20Windows%E6%B6%88%E6%81%AF%E9%92%A9%E5%8F%96/" title="第21章 Windows消息钩取">第21章 Windows消息钩取</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2020-02-13T00:52:05.000Z" title="发表于 2020-02-13 08:52:05">2020-02-13</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-comments"></i><a href="https://cyberangel.cn/2020/02/13/%E7%AC%AC21%E7%AB%A0%20Windows%E6%B6%88%E6%81%AF%E9%92%A9%E5%8F%96/#disqus_thread"></a><span class="article-meta-label"> 条评论</span></span></div><div class="content">21.1 钩子英文Hook 一词，翻成中文是“钩子”、“鱼钩”的意思，泛指钓取所需东西而使用的一切工具。“钩子”这一基本含义延伸发展为“偷看或截取信息时所用的手段或工具”。下面举例向各位进一步说明“钩子”这一概念。“钩子”的概念假设有一个非常重要的军事设施，其外围设置了 3 层岗哨以进行保护。外部人员若想进入，需要经过 3 层岗哨复杂的检查程序（身份确认、随身物品查验、访问事由说明等）。若间谍在通往该军事设施的道路上私设一个岗哨，经过该岗哨的人员未起疑心，通过时履行同样的检查程序，那么间谋就可以坐享其成，轻松获取（甚至可以操纵）来往该岗哨的所有信息。像这样，为了偷看或截取来往信息而在中间设置岗哨的行为称为“挂钩”（或“安装钩子”）实际上，偷看或操作信息的行为就是人们常说的“钩取”（Hooking)。   “钩取”技术广泛应用于计算机领域。其实，我们不仅可以查看来往于“OS-应用程序-用户”之间的全部信息，也可以操作它们，并且神不知鬼不觉。具体方法有很多，其中最基本的是“消息钩子”（Message Hook），下面会详细介绍。提示————————————————————————————— ...</div></div></div><div class="recent-post-item"><div class="post_cover left_radius"><a href="/2020/02/11/%E7%AC%AC20%E7%AB%A0%E2%80%9C%E5%86%85%E5%B5%8C%E8%A1%A5%E4%B8%81%E2%80%9D/" title="第20章“内嵌补丁”">     <img class="post_bg" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="第20章“内嵌补丁”"></a></div><div class="recent-post-info"><a class="article-title" href="/2020/02/11/%E7%AC%AC20%E7%AB%A0%E2%80%9C%E5%86%85%E5%B5%8C%E8%A1%A5%E4%B8%81%E2%80%9D/" title="第20章“内嵌补丁”">第20章“内嵌补丁”</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2020-02-11T08:21:14.000Z" title="发表于 2020-02-11 16:21:14">2020-02-11</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-comments"></i><a href="https://cyberangel.cn/2020/02/11/%E7%AC%AC20%E7%AB%A0%E2%80%9C%E5%86%85%E5%B5%8C%E8%A1%A5%E4%B8%81%E2%80%9D/#disqus_thread"></a><span class="article-meta-label"> 条评论</span></span></div><div class="content">练习对加密文件、运行时解压缩文件“打补丁”时，经常使用“内嵌补丁”（Inline Patch)技术，本章将通过示例让读者了解、学习。
20.1 内嵌补丁“内嵌补丁”是“内嵌代码补丁”（Inline Code Patch)的简称，难以直接修改指定代码时，插入并运行被称为“洞穴代码”（Code Cave)的补丁代码后，对程序打补丁。常用于对象程序经过运行时压缩（或加密处理）而难以直接修改的情况。详细说明参见图 20-1。图 20-1 左图描述的是典型的运行时压缩代码（或者加密代码）。EP 代码先将加密的 OEP 代码解密，然后再跳转到 OEP 代码处。若要打补丁的代码存在于经过加密的 OEP 区域是很难打补丁的（即使知道代码所在位置也是如此），因为解码过程中可能会解出完全不同的结果。解决上述问题的简单方法就是如图 20-1 中右图所示，在文件中另外设置被称为“洞穴代码”的“补丁代码”，EP 代码解密后修改 JMP 指令，运行洞穴代码。在洞穴代码中执行补丁代码后（由于已经解密 OEP，故可以这样修改），再跳转到 OEP 处。也就是说，每次运行时（运行另外的补丁代码）都要对进程内存的代码打补丁 ...</div></div></div><div class="recent-post-item"><div class="post_cover right_radius"><a href="/2020/02/11/%E7%AC%AC19%E7%AB%A0%20UPack%E8%B0%83%E8%AF%95-%E6%9F%A5%E6%89%BEOEP/" title="第19章 UPack调试-查找OEP">     <img class="post_bg" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="第19章 UPack调试-查找OEP"></a></div><div class="recent-post-info"><a class="article-title" href="/2020/02/11/%E7%AC%AC19%E7%AB%A0%20UPack%E8%B0%83%E8%AF%95-%E6%9F%A5%E6%89%BEOEP/" title="第19章 UPack调试-查找OEP">第19章 UPack调试-查找OEP</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2020-02-11T07:20:07.000Z" title="发表于 2020-02-11 15:20:07">2020-02-11</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-comments"></i><a href="https://cyberangel.cn/2020/02/11/%E7%AC%AC19%E7%AB%A0%20UPack%E8%B0%83%E8%AF%95-%E6%9F%A5%E6%89%BEOEP/#disqus_thread"></a><span class="article-meta-label"> 条评论</span></span></div><div class="content">本章将调试 UPack 压缩的记事本（notepad upack.exe）文件以查找 OEP。UPack 会对 PE 文件头进行独特变形，但并未应用反调试技术（Anti-Debugging），调试起来并不费劲。
19.1OllyDbg 运行错误由于 UPack 会将 IMAGE OPTIONAL HEADER 中的NumberOfRvaAndSizes 值设置为 A（默认值为 10），所以使用 OlyDbg 打开 notepad_upack.exe 文件时，初始检查过程中会弹出错误消息对话框，如图 19-1 所示。图 19-1OllyDbg 的错误消息框这不是什么非常严重的错误，按“确认”按钮关闭该对话框。上面这个错误导致 OllyDbg 无法转到 EP 位置，停留在 ntdll.dll 区域，如图 19-2 所示。该现象是由 OllyDbg 的 Bug（或者严格的 PE 检查）引起的，所以需要强制设置 EP。首先要查找 EP 位于何处。下面使用 Stud PE 查找 EP 的虚拟地址。如图 19-3 所示，ImageBase 为 01000000，EP 的 RVA 为 1018，经过 ...</div></div></div><nav id="pagination"><div class="pagination"><a class="extend prev" rel="prev" href="/page/16/#content-inner"><i class="fas fa-chevron-left fa-fw"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/16/#content-inner">16</a><span class="page-number current">17</span><a class="page-number" href="/page/18/#content-inner">18</a><span class="space">&hellip;</span><a class="page-number" href="/page/32/#content-inner">32</a><a class="extend next" rel="next" href="/page/18/#content-inner"><i class="fas fa-chevron-right fa-fw"></i></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/1.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Cyberangel</div><div class="author-info__description"></div></div><div class="card-info-data"><div class="card-info-data-item is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">317</div></a></div></div><a class="button--animated" id="card-info-btn" target="_blank" rel="noopener" href="https://www.yuque.com/cyberangel/"><i class="fab fa-github"></i><span>在语雀中关注我</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/cyberangel-kernel" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:995675318@qq.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a><a class="social-icon" href="https://www.yuque.com/cyberangel/" target="_blank" title="语雀"><i class="fab fa-alipay"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn card-announcement-animation"></i><span>公告</span></div><div class="announcement_content">Cyberangel的博客</div></div><div class="sticky_layout"><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2021/06/10/%E5%88%A9%E7%94%A8mprotect%E4%BF%AE%E6%94%B9%E7%A8%8B%E5%BA%8F%E6%AE%B5%E6%9D%83%E9%99%90%E4%B8%BA%E5%8F%AF%E6%89%A7%E8%A1%8C/" title="利用mprotect修改程序段权限为可执行"><img src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="利用mprotect修改程序段权限为可执行"/></a><div class="content"><a class="title" href="/2021/06/10/%E5%88%A9%E7%94%A8mprotect%E4%BF%AE%E6%94%B9%E7%A8%8B%E5%BA%8F%E6%AE%B5%E6%9D%83%E9%99%90%E4%B8%BA%E5%8F%AF%E6%89%A7%E8%A1%8C/" title="利用mprotect修改程序段权限为可执行">利用mprotect修改程序段权限为可执行</a><time datetime="2021-06-10T07:59:46.000Z" title="发表于 2021-06-10 15:59:46">2021-06-10</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/05/31/SROP%EF%BC%881%EF%BC%89--%E4%BB%8E%E4%B8%A4%E9%81%93%E9%A2%98%E9%87%8D%E6%96%B0%E8%AE%A4%E8%AF%86SROP%20attack/" title="SROP（1）--从两道题重新认识SROP attack"><img src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="SROP（1）--从两道题重新认识SROP attack"/></a><div class="content"><a class="title" href="/2021/05/31/SROP%EF%BC%881%EF%BC%89--%E4%BB%8E%E4%B8%A4%E9%81%93%E9%A2%98%E9%87%8D%E6%96%B0%E8%AE%A4%E8%AF%86SROP%20attack/" title="SROP（1）--从两道题重新认识SROP attack">SROP（1）--从两道题重新认识SROP attack</a><time datetime="2021-05-31T02:14:53.000Z" title="发表于 2021-05-31 10:14:53">2021-05-31</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/05/18/how2heap(14)-unsortedbin%20attack/" title="how2heap(14)-unsortedbin attack"><img src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="how2heap(14)-unsortedbin attack"/></a><div class="content"><a class="title" href="/2021/05/18/how2heap(14)-unsortedbin%20attack/" title="how2heap(14)-unsortedbin attack">how2heap(14)-unsortedbin attack</a><time datetime="2021-05-18T07:48:53.000Z" title="发表于 2021-05-18 15:48:53">2021-05-18</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/05/17/how2heap(13)-tcache_stashing_unlink_attack/" title="how2heap(13)-tcache_stashing_unlink_attack"><img src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="how2heap(13)-tcache_stashing_unlink_attack"/></a><div class="content"><a class="title" href="/2021/05/17/how2heap(13)-tcache_stashing_unlink_attack/" title="how2heap(13)-tcache_stashing_unlink_attack">how2heap(13)-tcache_stashing_unlink_attack</a><time datetime="2021-05-17T02:16:40.000Z" title="发表于 2021-05-17 10:16:40">2021-05-17</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/05/14/how2heap(12)-house%20of%20lore/" title="how2heap(12)-house of lore"><img src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="how2heap(12)-house of lore"/></a><div class="content"><a class="title" href="/2021/05/14/how2heap(12)-house%20of%20lore/" title="how2heap(12)-house of lore">how2heap(12)-house of lore</a><time datetime="2021-05-14T08:02:54.000Z" title="发表于 2021-05-14 16:02:54">2021-05-14</time></div></div></div></div><div class="card-widget card-archives"><div class="item-headline"><i class="fas fa-archive"></i><span>归档</span><a class="card-more-btn" href="/archives/" title="查看更多">
    <i class="fas fa-angle-right"></i></a></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2021/06/"><span class="card-archive-list-date">六月 2021</span><span class="card-archive-list-count">1</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2021/05/"><span class="card-archive-list-date">五月 2021</span><span class="card-archive-list-count">9</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2021/04/"><span class="card-archive-list-date">四月 2021</span><span class="card-archive-list-count">7</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2021/02/"><span class="card-archive-list-date">二月 2021</span><span class="card-archive-list-count">5</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2021/01/"><span class="card-archive-list-date">一月 2021</span><span class="card-archive-list-count">12</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2020/12/"><span class="card-archive-list-date">十二月 2020</span><span class="card-archive-list-count">7</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2020/11/"><span class="card-archive-list-date">十一月 2020</span><span class="card-archive-list-count">14</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2020/10/"><span class="card-archive-list-date">十月 2020</span><span class="card-archive-list-count">8</span></a></li></ul></div><div class="card-widget card-webinfo"><div class="item-headline"><i class="fas fa-chart-line"></i><span>网站资讯</span></div><div class="webinfo"><div class="webinfo-item"><div class="item-name">文章数目 :</div><div class="item-count">317</div></div><div class="webinfo-item"><div class="item-name">已运行时间 :</div><div class="item-count" id="runtimeshow" data-publishDate="2020-11-25T04:00:00.000Z"></div></div><div class="webinfo-item"><div class="item-name">本站总字数 :</div><div class="item-count">736.2k</div></div><div class="webinfo-item"><div class="item-name">本站访客数 :</div><div class="item-count" id="busuanzi_value_site_uv"></div></div><div class="webinfo-item"><div class="item-name">本站总访问量 :</div><div class="item-count" id="busuanzi_value_site_pv"></div></div><div class="webinfo-item"><div class="item-name">最后更新时间 :</div><div class="item-count" id="last-push-date" data-lastPushDate="2021-07-04T13:42:01.758Z"></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2019 - 2021 By Cyberangel</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">为世界上所有美好而战！！！</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="font-plus" type="button" title="放大字体"><i class="fas fa-plus"></i></button><button id="font-minus" type="button" title="缩小字体"><i class="fas fa-minus"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button id="chat_btn" type="button" title="rightside.chat_btn"><i class="fas fa-sms"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div></div><hr/><div id="local-search-results"></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="/js/search/local-search.js"></script><div class="js-pjax"><script>(() => {
  const getCount = () => {
    if (window.DISQUSWIDGETS === undefined) {
      var d = document, s = d.createElement('script');
      s.src = 'https://.disqus.com/count.js';
      s.id = 'dsq-count-scr';
      (d.head || d.body).appendChild(s);
    } else {
      DISQUSWIDGETS.getCount({reset: true});
    }
  }

  window.pjax ? getCount() : window.addEventListener('load', getCount)

})()</script><script>function subtitleType () {
  if (true) { 
    var typed = new Typed("#subtitle", {
      strings: "一名垃圾的Pwner".split(","),
      startDelay: 300,
      typeSpeed: 150,
      loop: true,
      backSpeed: 50
    })
  } else {
    document.getElementById("subtitle").innerHTML = '一'
  }
}

if (true) {
  if (typeof Typed === 'function') {
    subtitleType()
  } else {
    getScript('https://cdn.jsdelivr.net/npm/typed.js/lib/typed.min.js').then(subtitleType)
  }
} else {
  subtitleType()
}</script></div><canvas class="fireworks" mobile="true"></canvas><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/fireworks.min.js"></script><script defer="defer" id="ribbon" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-ribbon.min.js" size="150" alpha="0.6" zIndex="-1" mobile="false" data-click="false"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = true;
POWERMODE.mobile = true;
document.body.addEventListener('input', POWERMODE);
</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>