<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>PWN杂记（1-2）-《gcc中关于C语言char类型的这件事（1）》 | Cyberangel-blog</title><meta name="author" content="Cyberangel"><meta name="copyright" content="Cyberangel"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="附件下载：链接: https:&#x2F;&#x2F;pan.baidu.com&#x2F;s&#x2F;1UtQYcgZS_vQkIPUV5T5C5w   密码: e49d–来自百度网盘超级会员 V3 的分享  研究对象研究的 gcc 版本为：gcc version 5.4.0 20160609 (Ubuntu 5.4.0-6ubuntu1~16.04.12) 不同版本的 gcc 编译出来的程序可能不同。本文旨在了解 char 数组">
<meta property="og:type" content="article">
<meta property="og:title" content="PWN杂记（1-2）-《gcc中关于C语言char类型的这件事（1）》">
<meta property="og:url" content="https://cyberangel.cn/2021/01/27/PWN%E6%9D%82%E8%AE%B0%EF%BC%881-2%EF%BC%89-%E3%80%8Agcc%E4%B8%AD%E5%85%B3%E4%BA%8EC%E8%AF%AD%E8%A8%80char%E7%B1%BB%E5%9E%8B%E7%9A%84%E8%BF%99%E4%BB%B6%E4%BA%8B%EF%BC%881%EF%BC%89%E3%80%8B/index.html">
<meta property="og:site_name" content="Cyberangel-blog">
<meta property="og:description" content="附件下载：链接: https:&#x2F;&#x2F;pan.baidu.com&#x2F;s&#x2F;1UtQYcgZS_vQkIPUV5T5C5w   密码: e49d–来自百度网盘超级会员 V3 的分享  研究对象研究的 gcc 版本为：gcc version 5.4.0 20160609 (Ubuntu 5.4.0-6ubuntu1~16.04.12) 不同版本的 gcc 编译出来的程序可能不同。本文旨在了解 char 数组">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg">
<meta property="article:published_time" content="2021-01-27T02:08:30.000Z">
<meta property="article:modified_time" content="2021-07-04T09:57:13.399Z">
<meta property="article:author" content="Cyberangel">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://cyberangel.cn/2021/01/27/PWN%E6%9D%82%E8%AE%B0%EF%BC%881-2%EF%BC%89-%E3%80%8Agcc%E4%B8%AD%E5%85%B3%E4%BA%8EC%E8%AF%AD%E8%A8%80char%E7%B1%BB%E5%9E%8B%E7%9A%84%E8%BF%99%E4%BB%B6%E4%BA%8B%EF%BC%881%EF%BC%89%E3%80%8B/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    },
    fancybox: {
      js: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js',
      css: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isanchor: true
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'PWN杂记（1-2）-《gcc中关于C语言char类型的这件事（1）》',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2021-07-04 17:57:13'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const fontSizeVal = saveToLocal.get('global-font-size')
    if (fontSizeVal !== undefined) {
      document.documentElement.style.setProperty('--global-font-size', fontSizeVal + 'px')
    }
    
    const detectApple = () => {
      if (GLOBAL_CONFIG_SITE.isHome && /iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 5.4.0"><link rel="alternate" href="/atom.xml" title="Cyberangel-blog" type="application/atom+xml">
</head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/1.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">文章</div><div class="length-num">317</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">Cyberangel-blog</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">PWN杂记（1-2）-《gcc中关于C语言char类型的这件事（1）》</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2021-01-27T02:08:30.000Z" title="发表于 2021-01-27 10:08:30">2021-01-27</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2021-07-04T09:57:13.399Z" title="更新于 2021-07-04 17:57:13">2021-07-04</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">3.5k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>16分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="PWN杂记（1-2）-《gcc中关于C语言char类型的这件事（1）》"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span><span class="post-meta-separator">|</span><span class="post-meta-commentcount"><i class="far fa-comments fa-fw post-meta-icon"></i><span class="post-meta-label">评论数:</span><span class="disqus-comment-count"><a href="https://cyberangel.cn/2021/01/27/PWN%E6%9D%82%E8%AE%B0%EF%BC%881-2%EF%BC%89-%E3%80%8Agcc%E4%B8%AD%E5%85%B3%E4%BA%8EC%E8%AF%AD%E8%A8%80char%E7%B1%BB%E5%9E%8B%E7%9A%84%E8%BF%99%E4%BB%B6%E4%BA%8B%EF%BC%881%EF%BC%89%E3%80%8B/#disqus_thread"></a></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><blockquote>
<p>附件下载：<br>链接: <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1UtQYcgZS_vQkIPUV5T5C5w">https://pan.baidu.com/s/1UtQYcgZS_vQkIPUV5T5C5w</a>   密码: e49d<br>–来自百度网盘超级会员 V3 的分享</p>
</blockquote>
<h1 id="研究对象"><a href="#研究对象" class="headerlink" title="研究对象"></a>研究对象<img src="https://cdn.nlark.com/yuque/0/2021/png/574026/1611826067279-14dd4f5e-064e-43da-9cd0-f58492bf1f68.png#align=left&display=inline&height=838&margin=%5Bobject%20Object%5D&name=%E6%88%AA%E5%B1%8F2021-01-28%2017.27.33.png&originHeight=838&originWidth=2430&size=219938&status=done&style=none&width=2430" alt="截屏2021-01-28 17.27.33.png"></h1><p>研究的 gcc 版本为：gcc version 5.4.0 20160609 (Ubuntu 5.4.0-6ubuntu1~16.04.12) <br>不同版本的 gcc 编译出来的程序可能不同。<br><strong>本文旨在了解 char 数组和 char *的区别</strong></p>
<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>很早之前就想研究一下 C 中 char 类型的变量了，因为 char、char[]、char *等实在容易搞混，所以就想从内存的角度来研究一下。</p>
<blockquote>
<p>注意：char（char []）只能容纳字符，并不能容纳字符串。</p>
</blockquote>
<h1 id="代码编译"><a href="#代码编译" class="headerlink" title="代码编译"></a>代码编译</h1><blockquote>
<p>下面的代码是容易搞混的，我们使用 gcc 编译一下。</p>
</blockquote>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">char</span> a[<span class="number">10</span>]=&#123;<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;a&#x27;</span>&#125;;</span><br><span class="line">	<span class="keyword">char</span> m[]=&#123;<span class="string">&#x27;a&#x27;</span>,<span class="string">&quot;b&quot;</span>,<span class="string">&#x27;c&#x27;</span>,<span class="string">&#x27;d&#x27;</span>&#125;;</span><br><span class="line">	<span class="keyword">char</span> n[]=&#123;<span class="string">&#x27;m&#x27;</span>,<span class="string">&quot;nnnn&quot;</span>,<span class="string">&#x27;o&#x27;</span>,<span class="string">&#x27;d&#x27;</span>,<span class="string">&#x27;p&#x27;</span>,<span class="string">&quot;q&quot;</span>&#125;;</span><br><span class="line">	<span class="keyword">char</span>* b=<span class="string">&quot;bbbbbbb&quot;</span>;</span><br><span class="line">	<span class="keyword">char</span> c[<span class="number">10</span>]=<span class="string">&quot;ccccccc&quot;</span>;</span><br><span class="line">	<span class="keyword">char</span>* d[<span class="number">10</span>]=&#123;<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;c&#x27;</span>,<span class="string">&#x27;d&#x27;</span>,<span class="string">&#x27;e&#x27;</span>,<span class="string">&#x27;f&#x27;</span>,<span class="string">&#x27;g&#x27;</span>&#125;;</span><br><span class="line">	<span class="keyword">char</span>* e[<span class="number">10</span>]=&#123;<span class="string">&quot;a&quot;</span>,<span class="string">&quot;b&quot;</span>,<span class="string">&quot;c&quot;</span>,<span class="string">&quot;d&quot;</span>,<span class="string">&quot;e&quot;</span>,<span class="string">&quot;f&quot;</span>,<span class="string">&quot;g&quot;</span>&#125;;</span><br><span class="line">	<span class="keyword">const</span> <span class="keyword">char</span> f[<span class="number">10</span>]=&#123;<span class="string">&quot;fffffff&quot;</span>&#125;;</span><br><span class="line">	<span class="keyword">const</span> <span class="keyword">char</span>* g=<span class="string">&quot;ggggggg&quot;</span>;</span><br><span class="line">	<span class="keyword">char</span>* <span class="keyword">const</span> h=<span class="string">&quot;hhhhhhh&quot;</span>;</span><br><span class="line">	<span class="keyword">const</span> <span class="keyword">char</span>* <span class="keyword">const</span> i = <span class="string">&quot;iiiiiii&quot;</span>;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>编译命令：gcc -g test1.c -o test1</p>
</blockquote>
<p><img src="https://cdn.nlark.com/yuque/0/2021/png/574026/1611713880162-d4dd88bd-52f1-4d29-bf1d-e39549da877e.png#align=left&display=inline&height=1466&margin=%5Bobject%20Object%5D&name=%E6%88%AA%E5%B1%8F2021-01-27%2010.17.56.png&originHeight=1466&originWidth=2430&size=382540&status=done&style=none&width=2430" alt="截屏2021-01-27 10.17.56.png"><br>代码中有不合规的写法，产生了警告信息，这里先不用管它。</p>
<h1 id="调试"><a href="#调试" class="headerlink" title="调试"></a>调试</h1><p>gdb 调试程序断在 return 0 处<br><img src="https://cdn.nlark.com/yuque/0/2021/png/574026/1611714100639-c4ac8c52-a8f0-4445-a498-f0a961036a6e.png#align=left&display=inline&height=1552&margin=%5Bobject%20Object%5D&name=%E6%88%AA%E5%B1%8F2021-01-27%2010.21.36.png&originHeight=1552&originWidth=2428&size=336651&status=done&style=none&width=2428" alt="截屏2021-01-27 10.21.36.png"><br>看一下本地变量：<br><img src="https://cdn.nlark.com/yuque/0/2021/png/574026/1611714159951-cdee24d1-0b34-425a-9415-860f5286763d.png#align=left&display=inline&height=536&margin=%5Bobject%20Object%5D&name=%E6%88%AA%E5%B1%8F2021-01-27%2010.22.36.png&originHeight=536&originWidth=2430&size=97375&status=done&style=none&width=2430" alt="截屏2021-01-27 10.22.36.png"><br>有点乱，看一下内存可能更清楚：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">pwndbg&gt; x/<span class="number">30</span>gx <span class="number">0x7fffffffdcb0</span></span><br><span class="line"><span class="number">0x7fffffffdc90</span>:	<span class="number">0x000000000040078d</span>	<span class="number">0x00000000004007a1</span></span><br><span class="line">    			<span class="meta">#char* b			#const char* g</span></span><br><span class="line"><span class="number">0x7fffffffdca0</span>:	<span class="number">0x00000000004007a9</span>	<span class="number">0x00000000004007b1</span></span><br><span class="line">    			<span class="meta">#char* const h		#const char* const i</span></span><br><span class="line"><span class="number">0x7fffffffdcb0</span>:	<span class="number">0x0000000000000061</span>	<span class="number">0x0000000000000062</span> <span class="meta">#char* d[10]</span></span><br><span class="line">    			<span class="meta">#char* d[1]		    #char* d[2]</span></span><br><span class="line"><span class="number">0x7fffffffdcc0</span>:	<span class="number">0x0000000000000063</span>	<span class="number">0x0000000000000064</span></span><br><span class="line">        		<span class="meta">#char* d[3]			#char* d[4]</span></span><br><span class="line"><span class="number">0x7fffffffdcd0</span>:	<span class="number">0x0000000000000065</span>	<span class="number">0x0000000000000066</span></span><br><span class="line">    			<span class="meta">#char* d[5]			#char* d[6]</span></span><br><span class="line"><span class="number">0x7fffffffdce0</span>:	<span class="number">0x0000000000000067</span>	<span class="number">0x0000000000000000</span></span><br><span class="line">    			<span class="meta">#char* d[7]</span></span><br><span class="line"><span class="number">0x7fffffffdcf0</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span></span><br><span class="line"><span class="number">0x7fffffffdd00</span>:	<span class="number">0x0000000000400795</span>	<span class="number">0x0000000000400784</span> <span class="meta">#char* e[10]</span></span><br><span class="line">    			<span class="meta">#char* e[1]         #char* e[2]</span></span><br><span class="line"><span class="number">0x7fffffffdd10</span>:	<span class="number">0x0000000000400797</span>	<span class="number">0x0000000000400799</span></span><br><span class="line">    			<span class="meta">#char* e[3]         #char* e[4]</span></span><br><span class="line"><span class="number">0x7fffffffdd20</span>:	<span class="number">0x000000000040079b</span>	<span class="number">0x000000000040079d</span></span><br><span class="line">    			<span class="meta">#char* e[5]         #char* e[6]</span></span><br><span class="line"><span class="number">0x7fffffffdd30</span>:	<span class="number">0x000000000040079f</span>	<span class="number">0x0000000000000000</span></span><br><span class="line">    			<span class="meta">#char* e[7]</span></span><br><span class="line"><span class="number">0x7fffffffdd40</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span></span><br><span class="line"><span class="number">0x7fffffffdd50</span>:	<span class="number">0x0000000064638461</span>	<span class="number">0x00007fffffffddd0</span></span><br><span class="line"><span class="number">0x7fffffffdd60</span>:	<span class="number">0x00008b70646f866d</span>	<span class="number">0x00000000000000f0</span></span><br><span class="line"><span class="number">0x7fffffffdd70</span>:	<span class="number">0x0061616161616161</span>	<span class="number">0x0000000000400000</span></span><br><span class="line">    			<span class="meta">#char a[10]</span></span><br><span class="line"><span class="number">0x7fffffffdd80</span>:	<span class="number">0x0063636363636363</span>	<span class="number">0x0000000000000000</span></span><br><span class="line">    			<span class="meta">#char c[10]</span></span><br><span class="line"><span class="number">0x7fffffffdd90</span>:	<span class="number">0x0066666666666666</span>	<span class="number">0x0000000000400000</span></span><br><span class="line">    			<span class="meta">#const char f[10]</span></span><br><span class="line">pwndbg&gt;</span><br></pre></td></tr></table></figure>

<h1 id="分析"><a href="#分析" class="headerlink" title="分析"></a>分析</h1><p>为了说明的更清楚，我们结合 IDA 将所有的变量分析一下。</p>
<h2 id="栈空间初始化"><a href="#栈空间初始化" class="headerlink" title="栈空间初始化"></a>栈空间初始化</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">.text:<span class="number">0000000000400546</span>                 push    rbp</span><br><span class="line">.text:<span class="number">0000000000400547</span>                 mov     rbp, rsp</span><br><span class="line">.text:<span class="number">000000000040054</span>A                 sub     rsp, <span class="number">120</span>h  <span class="comment">//开辟所需要的栈空间</span></span><br><span class="line">.text:<span class="number">0000000000400551</span>                 mov     rax, fs:<span class="number">28</span>h</span><br><span class="line">.text:<span class="number">000000000040055</span>A                 mov     [rbp+var_8], rax <span class="comment">//保存canary</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>变量所需的空间是一步就初始化完成的。</p>
</blockquote>
<p>sub rsp, 120h 之前：<br><img src="https://cdn.nlark.com/yuque/0/2021/png/574026/1611720870228-2fb4d1ff-8e13-4c33-80f7-a167c407da3a.png#align=left&display=inline&height=310&margin=%5Bobject%20Object%5D&name=%E6%88%AA%E5%B1%8F2021-01-27%2012.14.27.png&originHeight=310&originWidth=2426&size=90852&status=done&style=none&width=2426" alt="截屏2021-01-27 12.14.27.png"><br>sub rsp, 120h 之后：<br><img src="https://cdn.nlark.com/yuque/0/2021/png/574026/1611720974424-ecc21ea2-7c77-479a-b447-6246515255f4.png#align=left&display=inline&height=312&margin=%5Bobject%20Object%5D&name=%E6%88%AA%E5%B1%8F2021-01-27%2012.16.10.png&originHeight=312&originWidth=2426&size=89026&status=done&style=none&width=2426" alt="截屏2021-01-27 12.16.10.png"></p>
<blockquote>
<p>栈的生长方向是由高地址到低地址。</p>
</blockquote>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">pwndbg&gt; x/<span class="number">40</span>gx <span class="number">0x7fffffffdc90</span></span><br><span class="line"><span class="number">0x7fffffffdc90</span>:	<span class="number">0x00007ffff7fd9700</span>	<span class="number">0x0000000000000000</span></span><br><span class="line">#现rsp</span><br><span class="line"><span class="number">0x7fffffffdca0</span>:	<span class="number">0x00007ffff7ffea88</span>	<span class="number">0x00007fffffffdce0</span></span><br><span class="line"><span class="number">0x7fffffffdcb0</span>:	<span class="number">0x0000000000000980</span>	<span class="number">0x00007fffffffdcd0</span></span><br><span class="line"><span class="number">0x7fffffffdcc0</span>:	<span class="number">0x000000006562b026</span>	<span class="number">0x00007ffff7b996e7</span></span><br><span class="line"><span class="number">0x7fffffffdcd0</span>:	<span class="number">0x00000000ffffffff</span>	<span class="number">0x00007ffff7ffe718</span></span><br><span class="line"><span class="number">0x7fffffffdce0</span>:	<span class="number">0x00007ffff7ffa280</span>	<span class="number">0x00007ffff7ffe700</span></span><br><span class="line"><span class="number">0x7fffffffdcf0</span>:	<span class="number">0x00007fffffffdd01</span>	<span class="number">0x00000ee90c4b5e16</span></span><br><span class="line"><span class="number">0x7fffffffdd00</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span></span><br><span class="line"><span class="number">0x7fffffffdd10</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span></span><br><span class="line"><span class="number">0x7fffffffdd20</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span></span><br><span class="line"><span class="number">0x7fffffffdd30</span>:	<span class="number">0x00007fffffffdea8</span>	<span class="number">0x0000000000000000</span></span><br><span class="line"><span class="number">0x7fffffffdd40</span>:	<span class="number">0x0000000000000001</span>	<span class="number">0x00007fffffffdea8</span></span><br><span class="line"><span class="number">0x7fffffffdd50</span>:	<span class="number">0x0000000000000001</span>	<span class="number">0x00007fffffffddd0</span></span><br><span class="line"><span class="number">0x7fffffffdd60</span>:	<span class="number">0x00007ffff7ffe168</span>	<span class="number">0x00000000000000f0</span></span><br><span class="line"><span class="number">0x7fffffffdd70</span>:	<span class="number">0x0000000000000001</span>	<span class="number">0x000000000040074d</span></span><br><span class="line"><span class="number">0x7fffffffdd80</span>:	<span class="number">0x00007fffffffddae</span>	<span class="number">0x0000000000000000</span></span><br><span class="line"><span class="number">0x7fffffffdd90</span>:	<span class="number">0x0000000000400700</span>	<span class="number">0x0000000000400450</span></span><br><span class="line"><span class="number">0x7fffffffdda0</span>:	<span class="number">0x00007fffffffde90</span>	<span class="number">0x0000000000000000</span></span><br><span class="line"><span class="number">0x7fffffffddb0</span>:	<span class="number">0x0000000000400700</span>	<span class="number">0x00007ffff7a2d840</span></span><br><span class="line">#原rsp（现rbp）</span><br><span class="line"><span class="number">0x7fffffffddc0</span>:	<span class="number">0x0000000000000001</span>	<span class="number">0x00007fffffffde98</span></span><br><span class="line">pwndbg&gt;</span><br></pre></td></tr></table></figure>

<p>“sub rsp, 120h”只是构造了 main 函数所需要的栈帧，并没有将原有的数据清空。</p>
<h2 id="char-a-10-‘a’-’a’-’a’-’a’-’a’-’a’-’a’"><a href="#char-a-10-‘a’-’a’-’a’-’a’-’a’-’a’-’a’" class="headerlink" title="char a[10]={‘a’,’a’,’a’,’a’,’a’,’a’,’a’};"></a>char a[10]={‘a’,’a’,’a’,’a’,’a’,’a’,’a’};</h2><p>首先来看一下 a 变量，这里定义了一个 char 类型的数组，然后将数组的前 7 个值赋值为字符’a’，看一下程序是怎么对 a 赋值的：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">.text:<span class="number">000000000040055</span>E                 <span class="keyword">xor</span>     eax, eax</span><br><span class="line">.text:<span class="number">0000000000400560</span>                 mov     qword ptr [rbp+a], <span class="number">0</span></span><br><span class="line">.text:<span class="number">0000000000400568</span>                 mov     word ptr [rbp+a+<span class="number">8</span>], <span class="number">0</span></span><br><span class="line">.text:<span class="number">000000000040056</span>E                 mov     [rbp+a], <span class="number">61</span>h</span><br><span class="line">.text:<span class="number">0000000000400572</span>                 mov     [rbp+a+<span class="number">1</span>], <span class="number">61</span>h</span><br><span class="line">.text:<span class="number">0000000000400576</span>                 mov     [rbp+a+<span class="number">2</span>], <span class="number">61</span>h</span><br><span class="line">.text:<span class="number">000000000040057</span>A                 mov     [rbp+a+<span class="number">3</span>], <span class="number">61</span>h</span><br><span class="line">.text:<span class="number">000000000040057</span>E                 mov     [rbp+a+<span class="number">4</span>], <span class="number">61</span>h</span><br><span class="line">.text:<span class="number">0000000000400582</span>                 mov     [rbp+a+<span class="number">5</span>], <span class="number">61</span>h</span><br><span class="line">.text:<span class="number">0000000000400586</span>                 mov     [rbp+a+<span class="number">6</span>], <span class="number">61</span>h</span><br></pre></td></tr></table></figure>

<p>向内存填充数据之前：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">pwndbg&gt; x/<span class="number">4</span>gx <span class="number">0x7fffffffdd70</span></span><br><span class="line"><span class="number">0x7fffffffdd70</span>:	<span class="number">0x0000000000000001</span>	<span class="number">0x000000000040074d</span> <span class="meta">#a的栈空间</span></span><br><span class="line"><span class="number">0x7fffffffdd80</span>:	<span class="number">0x00007fffffffddae</span>	<span class="number">0x0000000000000000</span></span><br><span class="line">pwndbg&gt;</span><br></pre></td></tr></table></figure>

<p>可以看到，a 变量的栈空间是有数据的，因此在使用前需要根据 a 变量所需的空间大小清空 a 空间中原有的数据：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">.text:<span class="number">0000000000400560</span>                 mov     qword ptr [rbp+a], <span class="number">0</span></span><br><span class="line">.text:<span class="number">0000000000400568</span>                 mov     word ptr [rbp+a+<span class="number">8</span>], <span class="number">0</span></span><br></pre></td></tr></table></figure>

<p>执行 mov qword ptr [rbp+a], 0：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">pwndbg&gt; x/<span class="number">4</span>gx <span class="number">0x7fffffffdd70</span></span><br><span class="line"><span class="number">0x7fffffffdd70</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x000000000040074d</span> <span class="meta">#a的栈空间</span></span><br><span class="line">				# $$$$$$$$$$$$$$$$</span><br><span class="line">				<span class="meta">#a的栈空间起始地址</span></span><br><span class="line"><span class="number">0x7fffffffdd80</span>:	<span class="number">0x00007fffffffddae</span>	<span class="number">0x0000000000000000</span></span><br><span class="line">pwndbg&gt;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>这里的’$’代表执行mov qword ptr [rbp+a],0后所影响的内存；1qword=4word=8byte=16个’$’</p>
</blockquote>
<p>执行 mov  word ptr [rbp+a+8], 0</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">pwndbg&gt; x/<span class="number">4</span>gx <span class="number">0x7fffffffdd70</span></span><br><span class="line"><span class="number">0x7fffffffdd70</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000400000</span> <span class="meta">#a的栈空间</span></span><br><span class="line">									#             $$$$</span><br><span class="line"><span class="number">0x7fffffffdd80</span>:	<span class="number">0x00007fffffffddae</span>	<span class="number">0x0000000000000000</span></span><br><span class="line">pwndbg&gt;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>1word=2byte=8 个$</p>
</blockquote>
<p>现在 a 变量的空间已经全部清零，现在向这个空间中逐个写入字符’a’（0x61）就可以了：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">pwndbg&gt; x/<span class="number">4</span>gx <span class="number">0x7fffffffdd70</span></span><br><span class="line"><span class="number">0x7fffffffdd70</span>:	<span class="number">0x0061616161616161</span>	<span class="number">0x0000000000400000</span></span><br><span class="line">    			# @@@@@@@@@@@@@@@@  #             @@@@</span><br><span class="line"><span class="number">0x7fffffffdd80</span>:	<span class="number">0x00007fffffffddae</span>	<span class="number">0x0000000000000000</span></span><br><span class="line">pwndbg&gt;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>@代表 a 变量的总空间</p>
</blockquote>
<p>**因此 char a[10]={‘a’,’a’,’a’,’a’,’a’,’a’,’a’};的意思是在一片连续的栈空间中初始化 10 字节（byte）的空间，然后将对应数量的字符 a 逐个写入即可。同时说明程序编译之后变量 a 的内容可以被修改。<br>**</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">pwndbg&gt; x/<span class="number">4</span>gx &amp;a[<span class="number">0</span>]</span><br><span class="line"><span class="number">0x7fffffffdd70</span>:	<span class="number">0x0061616161616161</span>	<span class="number">0x0000000000400000</span></span><br><span class="line"><span class="number">0x7fffffffdd80</span>:	<span class="number">0x00007fffffffddae</span>	<span class="number">0x0000000000000000</span></span><br><span class="line">#如果使用x/gx &amp;a[?]来查看变量的值时：</span><br><span class="line">#<span class="number">0x7fffffffdd70</span>:	<span class="number">0x0061616161616161</span></span><br><span class="line">    								??</span><br><span class="line">#??处代表数组中某个下标（&amp;a[?]）对应的值</span><br><span class="line">#但是由于<span class="keyword">char</span>中存放的是字符，推荐使用x/bx &amp;a[<span class="number">1</span>]来查看：</span><br><span class="line"><span class="meta">#pwndbg&gt; x/bx &amp;a[1]</span></span><br><span class="line">#<span class="number">0x7fffffffdd71</span>:	<span class="number">0x61</span></span><br><span class="line">-------------------------------------------------------------</span><br><span class="line">pwndbg&gt; x/bx *a[<span class="number">0</span>]</span><br><span class="line">Cannot access memory at address <span class="number">0x61</span></span><br><span class="line">pwndbg&gt;</span><br><span class="line"><span class="meta">#x/bx *a[0]代表的含义是查看数组a[0]中的值，然后以这个值为地址查看其中的内容。</span></span><br><span class="line"><span class="meta">#x/bx &amp;a[0]代表的含义是查看数组a[0]中的值（查看a[0]地址处所存放的值）。</span></span><br></pre></td></tr></table></figure>

<h2 id="char-m-‘a’-”b”-’c’-’d’-（ERROR）"><a href="#char-m-‘a’-”b”-’c’-’d’-（ERROR）" class="headerlink" title="char m[]={‘a’,”b”,’c’,’d’};（ERROR）"></a>char m[]={‘a’,”b”,’c’,’d’};（ERROR）</h2><p>首先说明，char 数组中存放字符串是一种错误的写法，初学者很容易犯这个错误，否则在编译程序时会出现警告：<br><img src="https://cdn.nlark.com/yuque/0/2021/png/574026/1611724940879-998dff3d-5cd4-4b5d-a339-c7dd8e3b1acd.png#align=left&display=inline&height=134&margin=%5Bobject%20Object%5D&name=%E6%88%AA%E5%B1%8F2021-01-27%2013.22.15.png&originHeight=134&originWidth=1382&size=101009&status=done&style=none&width=1382" alt="截屏2021-01-27 13.22.15.png"></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">.text:<span class="number">000000000040058</span>A                 mov     [rbp+m], <span class="number">61</span>h</span><br><span class="line">.text:<span class="number">000000000040058</span>E                 mov     eax, offset unk_400784</span><br><span class="line">.text:<span class="number">0000000000400593</span>                 mov     [rbp+m+<span class="number">1</span>], al</span><br><span class="line">.text:<span class="number">0000000000400596</span>                 mov     [rbp+m+<span class="number">2</span>], <span class="number">63</span>h</span><br><span class="line">.text:<span class="number">000000000040059</span>A                 mov     [rbp+m+<span class="number">3</span>], <span class="number">64</span>h</span><br></pre></td></tr></table></figure>

<p>地址 0x400784 存放的是“数据 0x62”，如下图所示：<br><img src="https://cdn.nlark.com/yuque/0/2021/png/574026/1611724562140-fd7fa781-0da3-4fff-87c4-80d0a7e0e4ae.png#align=left&display=inline&height=90&margin=%5Bobject%20Object%5D&name=%E6%88%AA%E5%B1%8F2021-01-27%2013.15.58.png&originHeight=90&originWidth=1470&size=40542&status=done&style=none&width=1470" alt="截屏2021-01-27 13.15.58.png"></p>
<p>对比 m 变量写入内容的前后：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">pwndbg&gt; x/<span class="number">4</span>gx &amp;m</span><br><span class="line"><span class="number">0x7fffffffdda0</span>:	<span class="number">0x0000000000000001</span>	<span class="number">0x00007fffffffde20</span></span><br><span class="line"><span class="number">0x7fffffffddb0</span>:	<span class="number">0x00007ffff7ffe168</span>	<span class="number">0x00000000000000f0</span></span><br><span class="line">pwndbg&gt;</span><br><span class="line">----------------------------------------------------------</span><br><span class="line">pwndbg&gt; x/<span class="number">4</span>gx &amp;m</span><br><span class="line"><span class="number">0x7fffffffdda0</span>:	<span class="number">0x0000000064638461</span>	<span class="number">0x00007fffffffde20</span></span><br><span class="line"><span class="number">0x7fffffffddb0</span>:	<span class="number">0x00007ffff7ffe168</span>	<span class="number">0x00000000000000f0</span></span><br><span class="line">pwndbg&gt;</span><br></pre></td></tr></table></figure>

<blockquote>
<p><strong>char a[10]={data}会将 a 变量所占有的栈空间初始化为 0，但是 char m[]={data}并不会。</strong></p>
</blockquote>
<p>来观察一下上面的内存，“数据”b””写入时发生了错误，本应写入 0x0000000064636261，但实际上写入的是 0x0000000064638461，这是发生了什么原因？来看一下汇编代码：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">.text:<span class="number">000000000040058</span>E                 mov     eax, offset unk_400784</span><br><span class="line">.text:<span class="number">0000000000400593</span>                 mov     [rbp+m+<span class="number">1</span>], al</span><br><span class="line">-------------------------------------------------------------------------</span><br><span class="line">.rodata:<span class="number">0000000000400784</span> unk_400784      db  <span class="number">62</span>h ; b             ; DATA XREF: main+<span class="number">48</span>↑o</span><br></pre></td></tr></table></figure>

<p>首先程序将”数据 0x62”放入到了 eax 中，然后将 eax 的低 8 位中的数据再放入栈中，这也许就是数据发生错误的原因，调试跟踪一下：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">数据放入eax前，RAX寄存器的值为空：</span><br><span class="line">RAX  <span class="number">0x0</span></span><br><span class="line">单步，数据放入之后：</span><br><span class="line">*RAX  <span class="number">0x400784</span> ◂— <span class="number">0x71006e6e6e6e0062</span> <span class="comment">/* &#x27;b&#x27; */</span></span><br><span class="line">现在RAX中存放的是地址<span class="number">0x400784</span>，这个地址存放的数据为字符<span class="string">&#x27;b&#x27;</span>,看一下此时寄存器状况：</span><br><span class="line">pwndbg&gt; x/gx $rax</span><br><span class="line"><span class="number">0x400784</span>:	<span class="number">0x71006e6e6e6e0062</span></span><br><span class="line">pwndbg&gt; x/gx $al</span><br><span class="line"><span class="number">0xffffffffffffff84</span>:	Cannot access memory at address <span class="number">0xffffffffffffff84</span></span><br><span class="line">al显示的是<span class="number">0xffffffffffffff84</span>，应该是从rax到al的数据转换出现了问题才导致的错误。</span><br></pre></td></tr></table></figure>

<p><strong>综上，char 数组中不可以有字符串的出现，否则会导致数据错误。</strong></p>
<h2 id="char-n-‘m’-”nnnn”-’o’-’d’-’p’-”q”-（ERROR）"><a href="#char-n-‘m’-”nnnn”-’o’-’d’-’p’-”q”-（ERROR）" class="headerlink" title="char n[]={‘m’,”nnnn”,’o’,’d’,’p’,”q”};（ERROR）"></a>char n[]={‘m’,”nnnn”,’o’,’d’,’p’,”q”};（ERROR）</h2><p>继续来看汇编：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">.text:<span class="number">000000000040059</span>E                 mov     [rbp+n], <span class="number">6</span>Dh</span><br><span class="line">.text:<span class="number">00000000004005</span>A2                 mov     eax, offset aNnnn ; <span class="string">&quot;nnnn&quot;</span></span><br><span class="line">.text:<span class="number">00000000004005</span>A7                 mov     [rbp+n+<span class="number">1</span>], al</span><br><span class="line">.text:<span class="number">00000000004005</span>AA                 mov     [rbp+n+<span class="number">2</span>], <span class="number">6F</span>h</span><br><span class="line">.text:<span class="number">00000000004005</span>AE                 mov     [rbp+n+<span class="number">3</span>], <span class="number">64</span>h</span><br><span class="line">.text:<span class="number">00000000004005B</span>2                 mov     [rbp+n+<span class="number">4</span>], <span class="number">70</span>h</span><br><span class="line">.text:<span class="number">00000000004005B</span>6                 mov     eax, offset aQ  ; <span class="string">&quot;q&quot;</span></span><br><span class="line">.text:<span class="number">00000000004005B</span>B                 mov     [rbp+n+<span class="number">5</span>], al</span><br><span class="line">-----------------------------------------------------------------------</span><br><span class="line">.rodata:<span class="number">0000000000400786</span> aNnnn           db <span class="string">&#x27;nnnn&#x27;</span>,<span class="number">0</span>             ; DATA XREF: main+<span class="number">5</span>C↑o</span><br><span class="line">.rodata:<span class="number">000000000040078B</span> aQ              db <span class="string">&#x27;q&#x27;</span>,<span class="number">0</span>                ; DATA XREF: main+<span class="number">70</span>↑o</span><br></pre></td></tr></table></figure>

<p>由于这个 char 数组中仍然存在两个字符串，因此写入之后会导致错误：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">pwndbg&gt; x/<span class="number">2</span>gx &amp;n</span><br><span class="line"><span class="number">0x7fffffffddb0</span>:	<span class="number">0x00008b70646f866d</span>	<span class="number">0x00000000000000f0</span> #??表示数据出错的地方。</span><br><span class="line">    		   #<span class="number">0</span>x    ??<span class="number">70646f</span>??<span class="number">6</span>d</span><br><span class="line">pwndbg&gt;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>和之前一样，使用 char n[]不会初始化 n 变量栈空间为 0，并且数据都是直接写入栈的，同时也暗示了 char n[]={data}中的 data 在定义后可以被修改。<br>无论定义时字符串的长度为多少，都会被 al 寄存器截断为 1byte。</p>
</blockquote>
<h2 id="char-b-”bbbbbbb”"><a href="#char-b-”bbbbbbb”" class="headerlink" title="char* b=”bbbbbbb”;"></a>char* b=”bbbbbbb”;</h2><p>汇编如下：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">.text:<span class="number">00000000004005B</span>E        mov     [rbp+b], offset aBbbbbbb ; <span class="string">&quot;bbbbbbb&quot;</span></span><br><span class="line">---------------------------------------------------------------------------</span><br><span class="line">.rodata:<span class="number">000000000040078</span>D aBbbbbbb        db <span class="string">&#x27;bbbbbbb&#x27;</span>,<span class="number">0</span>          ; DATA XREF: main+<span class="number">78</span>↑o</span><br></pre></td></tr></table></figure>

<p>写入内存之后：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">pwndbg&gt; x/<span class="number">4</span>gx &amp;b</span><br><span class="line"><span class="number">0x7fffffffdce0</span>:	<span class="number">0x000000000040078d</span>	<span class="number">0x0000000000000000</span></span><br><span class="line"><span class="number">0x7fffffffdcf0</span>:	<span class="number">0x00007ffff7ffea88</span>	<span class="number">0x00007fffffffdd30</span></span><br><span class="line">pwndbg&gt; x/<span class="number">2</span>gx <span class="number">0x000000000040078d</span></span><br><span class="line"><span class="number">0x40078d</span>:	<span class="number">0x0062626262626262</span>	<span class="number">0x0065006400630061</span></span><br><span class="line">pwndbg&gt; x/<span class="number">4</span>gx b</span><br><span class="line"><span class="number">0x40078d</span>:	<span class="number">0x0062626262626262</span>	<span class="number">0x0065006400630061</span></span><br><span class="line"><span class="number">0x40079d</span>:	<span class="number">0x6767676700670066</span>	<span class="number">0x6868686800676767</span></span><br><span class="line">pwndbg&gt; x/<span class="number">4</span>gx *b</span><br><span class="line"><span class="number">0x62</span>:	Cannot access memory at address <span class="number">0x62</span></span><br><span class="line">pwndbg&gt;</span><br></pre></td></tr></table></figure>

<p>在之前的调试中，x/4gx &amp;b 和 x/4gx b 得到的结果是相同的（之后的篇幅未说明则相同），但是这里却发生了变化，推测这是由于定义变量时使用了 char <em>导致的；仔细观察可以得出一个简单结论：<br>b 变量被定义为 char</em> b（char *b），因此 b 是一个指针，它指向存放于.rodata 段的’bbbbbbb’，而 gdb 中的 x/4gx &amp;b 指的是查看 b 指针存放的地址，x/4gx b 是查看 b 指针指向的内容。进一步，“ mov [rbp+b], offset aBbbbbbb ;”的意思是将’bbbbbbb’所存放的地址写入到[rbp+b]中（也可以理解为指针）。</p>
<blockquote>
<p>.rodata 段即 read only data，存放于该段的数据是只读的。<br>注：存放于栈的指针 b 可以被修改，但是指向的数据’bbbbbbb’无法更改，和之后的 const char* g 效果相同</p>
</blockquote>
<h2 id="char-c-10-”ccccccc”"><a href="#char-c-10-”ccccccc”" class="headerlink" title="char c[10]=”ccccccc”;"></a>char c[10]=”ccccccc”;</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">.text:<span class="number">00000000004005</span>C9                 mov     rax, <span class="number">63636363636363</span>h</span><br><span class="line">.text:<span class="number">00000000004005</span>D3                 mov     qword ptr [rbp+c], rax</span><br><span class="line">.text:<span class="number">00000000004005</span>D7                 mov     word ptr [rbp+c+<span class="number">8</span>], <span class="number">0</span></span><br></pre></td></tr></table></figure>

<p>看一下写入之前之后的内存：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">写入之前：</span><br><span class="line">pwndbg&gt; x/<span class="number">2</span>gx &amp;c</span><br><span class="line"><span class="number">0x7fffffffddd0</span>:	<span class="number">0x00007fffffffddfe</span>	<span class="number">0x0000000000000000</span></span><br><span class="line">pwndbg&gt;</span><br><span class="line">写入之后：</span><br><span class="line">pwndbg&gt; x/<span class="number">2</span>gx &amp;c</span><br><span class="line"><span class="number">0x7fffffffddd0</span>:	<span class="number">0x0063636363636363</span>	<span class="number">0x0000000000000000</span></span><br><span class="line">               	<span class="meta">#mov qword ptr [rbp+c], rax -&gt;0x??63636363636363</span></span><br><span class="line">    			<span class="meta">#mov word ptr [rbp+c+8], 0 -&gt;0x00??????????????</span></span><br><span class="line">    			#上面的??代表执行汇编指令后<span class="number">0x7fffffffddd0</span>未受影响到的内存</span><br><span class="line">pwndbg&gt;</span><br></pre></td></tr></table></figure>

<p><strong>和之前 char *b 不同的是，由于变量 c 的数据是由寄存器直接 mov 到栈的，因此数据可读可修改。</strong></p>
<h2 id="char-d-10-‘a’-’b’-’c’-’d’-’e’-’f’-’g’-（ERROR）"><a href="#char-d-10-‘a’-’b’-’c’-’d’-’e’-’f’-’g’-（ERROR）" class="headerlink" title="char* d[10]={‘a’,’b’,’c’,’d’,’e’,’f’,’g’};（ERROR）"></a>char* d[10]={‘a’,’b’,’c’,’d’,’e’,’f’,’g’};（ERROR）</h2><p>这个也是编译时发生警告的地方，说明这种定义方法不恰当。</p>
<h1 id=""><a href="#" class="headerlink" title=""></a><img src="https://cdn.nlark.com/yuque/0/2021/png/574026/1611810278033-212d891c-1924-49ad-b377-f7acbb957b43.png#align=left&display=inline&height=718&margin=%5Bobject%20Object%5D&name=%E6%88%AA%E5%B1%8F2021-01-28%2013.04.30.png&originHeight=718&originWidth=1378&size=590159&status=done&style=none&width=1378" alt="截屏2021-01-28 13.04.30.png"></h1><p>先来看第一部分的汇编：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">.text:<span class="number">00000000004005</span>DD                 lea     rdx, [rbp+d]</span><br><span class="line">.text:<span class="number">00000000004005E4</span>                 mov     eax, <span class="number">0</span></span><br><span class="line">.text:<span class="number">00000000004005E9</span>                 mov     ecx, <span class="number">0</span>Ah</span><br><span class="line">.text:<span class="number">00000000004005</span>EE                 mov     rdi, rdx</span><br><span class="line">.text:<span class="number">00000000004005F</span>1                 rep stosq</span><br><span class="line"><span class="meta">#rep指令的目的是重复其上面的指令.ECX的值是重复的次数.</span></span><br><span class="line">#STOS指令的作用是将rax中的值拷贝到ES:RDI指向的地址.</span><br><span class="line"><span class="meta">#q代表qword</span></span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.nlark.com/yuque/0/2021/png/574026/1611810661650-3c070875-8175-4ae3-b35e-ee79cfeb82c7.png#align=left&display=inline&height=246&margin=%5Bobject%20Object%5D&name=%E6%88%AA%E5%B1%8F2021-01-28%2013.10.56.png&originHeight=246&originWidth=2430&size=65057&status=done&style=none&width=2430" alt="截屏2021-01-28 13.10.56.png"></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">pwndbg&gt; x/<span class="number">20</span>gx &amp;d</span><br><span class="line"><span class="number">0x7fffffffdd00</span>:	<span class="number">0x0000000000000980</span>	<span class="number">0x00007fffffffdd20</span></span><br><span class="line"><span class="number">0x7fffffffdd10</span>:	<span class="number">0x000000006562b026</span>	<span class="number">0x00007ffff7b996e7</span></span><br><span class="line"><span class="number">0x7fffffffdd20</span>:	<span class="number">0x00000000ffffffff</span>	<span class="number">0x00007ffff7ffe718</span></span><br><span class="line"><span class="number">0x7fffffffdd30</span>:	<span class="number">0x00007ffff7ffa280</span>	<span class="number">0x00007ffff7ffe700</span></span><br><span class="line"><span class="number">0x7fffffffdd40</span>:	<span class="number">0x00007fffffffdd01</span>	<span class="number">0x00003ee6c929dc69</span></span><br><span class="line"><span class="number">0x7fffffffdd50</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span></span><br><span class="line"><span class="number">0x7fffffffdd60</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span></span><br><span class="line"><span class="number">0x7fffffffdd70</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span></span><br><span class="line"><span class="number">0x7fffffffdd80</span>:	<span class="number">0x00007fffffffdef8</span>	<span class="number">0x0000000000000000</span></span><br><span class="line"><span class="number">0x7fffffffdd90</span>:	<span class="number">0x0000000000000001</span>	<span class="number">0x00007fffffffdef8</span></span><br><span class="line">pwndbg&gt;</span><br><span class="line">-------------------------------------------------------------#执行之后：</span><br><span class="line">pwndbg&gt; x/<span class="number">20</span>gx &amp;d</span><br><span class="line"><span class="number">0x7fffffffdd00</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span> <span class="meta">#changed</span></span><br><span class="line"><span class="number">0x7fffffffdd10</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span> <span class="meta">#changed</span></span><br><span class="line"><span class="number">0x7fffffffdd20</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span> <span class="meta">#changed</span></span><br><span class="line"><span class="number">0x7fffffffdd30</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span> <span class="meta">#changed</span></span><br><span class="line"><span class="number">0x7fffffffdd40</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span> <span class="meta">#changed</span></span><br><span class="line"><span class="number">0x7fffffffdd50</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span> <span class="meta">#nochanged</span></span><br><span class="line"><span class="number">0x7fffffffdd60</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span> <span class="meta">#nochanged</span></span><br><span class="line"><span class="number">0x7fffffffdd70</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span> <span class="meta">#nochanged</span></span><br><span class="line"><span class="number">0x7fffffffdd80</span>:	<span class="number">0x00007fffffffdef8</span>	<span class="number">0x0000000000000000</span> <span class="meta">#nochanged</span></span><br><span class="line"><span class="number">0x7fffffffdd90</span>:	<span class="number">0x0000000000000001</span>	<span class="number">0x00007fffffffdef8</span> <span class="meta">#nochanged</span></span><br><span class="line">pwndbg&gt;</span><br></pre></td></tr></table></figure>

<p>易得：这段代码的作用是将之后所需要的栈空间进行清空，防止受原来的数据干扰。之后就是将数据写入内存中：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">.text:<span class="number">00000000004005F</span>4                 mov     [rbp+d], <span class="number">61</span>h</span><br><span class="line">.text:<span class="number">00000000004005F</span>F                 mov     [rbp+d+<span class="number">8</span>], <span class="number">62</span>h</span><br><span class="line">.text:<span class="number">000000000040060</span>A                 mov     [rbp+d+<span class="number">10</span>h], <span class="number">63</span>h</span><br><span class="line">.text:<span class="number">0000000000400615</span>                 mov     [rbp+d+<span class="number">18</span>h], <span class="number">64</span>h</span><br><span class="line">.text:<span class="number">0000000000400620</span>                 mov     [rbp+d+<span class="number">20</span>h], <span class="number">65</span>h</span><br><span class="line">.text:<span class="number">000000000040062B</span>                 mov     [rbp+d+<span class="number">28</span>h], <span class="number">66</span>h</span><br><span class="line">.text:<span class="number">0000000000400636</span>                 mov     [rbp+d+<span class="number">30</span>h], <span class="number">67</span>h</span><br></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">pwndbg&gt; x/<span class="number">20</span>gx &amp;d</span><br><span class="line"><span class="number">0x7fffffffdd00</span>:	<span class="number">0x0000000000000061</span>	<span class="number">0x0000000000000062</span> <span class="meta">#changed</span></span><br><span class="line"><span class="number">0x7fffffffdd10</span>:	<span class="number">0x0000000000000063</span>	<span class="number">0x0000000000000064</span> <span class="meta">#changed</span></span><br><span class="line"><span class="number">0x7fffffffdd20</span>:	<span class="number">0x0000000000000065</span>	<span class="number">0x0000000000000066</span> <span class="meta">#changed</span></span><br><span class="line"><span class="number">0x7fffffffdd30</span>:	<span class="number">0x0000000000000067</span>	<span class="number">0x0000000000000000</span> <span class="meta">#changed</span></span><br><span class="line"><span class="number">0x7fffffffdd40</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span></span><br><span class="line">......(未受影响的内存)</span><br><span class="line"><span class="number">0x7fffffffdd90</span>:	<span class="number">0x0000000000000001</span>	<span class="number">0x00007fffffffdef8</span></span><br><span class="line">pwndbg&gt;</span><br></pre></td></tr></table></figure>

<p>写入数据的方式和之前的都不相同，为了研究这种情况，我们继续向下走。</p>
<h2 id="char-e-10-“a”-”b”-”c”-”d”-”e”-”f”-”g”"><a href="#char-e-10-“a”-”b”-”c”-”d”-”e”-”f”-”g”" class="headerlink" title="char* e[10]={“a”,”b”,”c”,”d”,”e”,”f”,”g”};"></a>char* e[10]={“a”,”b”,”c”,”d”,”e”,”f”,”g”};</h2><p>和之前的一样，所需的栈空间清零：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">.text:<span class="number">0000000000400641</span>                 lea     rdx, [rbp+e]</span><br><span class="line">.text:<span class="number">0000000000400648</span>                 mov     eax, <span class="number">0</span></span><br><span class="line">.text:<span class="number">000000000040064</span>D                 mov     ecx, <span class="number">0</span>Ah</span><br><span class="line">.text:<span class="number">0000000000400652</span>                 mov     rdi, rdx</span><br><span class="line">.text:<span class="number">0000000000400655</span>                 rep stosq</span><br></pre></td></tr></table></figure>

<p>开始写入数据：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">.text:<span class="number">0000000000400658</span>                 mov     [rbp+e], offset aA ; <span class="string">&quot;a&quot;</span></span><br><span class="line">.text:<span class="number">0000000000400663</span>                 mov     [rbp+e+<span class="number">8</span>], offset unk_400784</span><br><span class="line">.text:<span class="number">000000000040066</span>E                 mov     [rbp+e+<span class="number">10</span>h], offset aC ; <span class="string">&quot;c&quot;</span></span><br><span class="line">.text:<span class="number">0000000000400679</span>                 mov     [rbp+e+<span class="number">18</span>h], offset aD ; <span class="string">&quot;d&quot;</span></span><br><span class="line">.text:<span class="number">0000000000400684</span>                 mov     [rbp+e+<span class="number">20</span>h], offset aE ; <span class="string">&quot;e&quot;</span></span><br><span class="line">.text:<span class="number">000000000040068F</span>                 mov     [rbp+e+<span class="number">28</span>h], offset asc_40079D ; <span class="string">&quot;f&quot;</span></span><br><span class="line">.text:<span class="number">000000000040069</span>A                 mov     [rbp+e+<span class="number">30</span>h], offset aG ; <span class="string">&quot;g&quot;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">pwndbg&gt; x/<span class="number">16</span>gx &amp;e</span><br><span class="line"><span class="number">0x7fffffffdd50</span>:	<span class="number">0x0000000000400795</span>	<span class="number">0x0000000000400784</span> <span class="meta">#changed</span></span><br><span class="line"><span class="number">0x7fffffffdd60</span>:	<span class="number">0x0000000000400797</span>	<span class="number">0x0000000000400799</span> <span class="meta">#changed</span></span><br><span class="line"><span class="number">0x7fffffffdd70</span>:	<span class="number">0x000000000040079b</span>	<span class="number">0x000000000040079d</span> <span class="meta">#changed</span></span><br><span class="line"><span class="number">0x7fffffffdd80</span>:	<span class="number">0x000000000040079f</span>	<span class="number">0x0000000000000000</span> <span class="meta">#changed</span></span><br><span class="line"><span class="number">0x7fffffffdd90</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x0000000000000000</span> <span class="meta">#changed</span></span><br><span class="line">......</span><br><span class="line">pwndbg&gt;</span><br></pre></td></tr></table></figure>

<p>总结：<strong>char* e[10]={}要求写入的是字符串（指针）而不是字符，定义后数据不可更改：</strong></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">.rodata:<span class="number">0000000000400795</span> aA              db <span class="string">&#x27;a&#x27;</span>,<span class="number">0</span>                ; DATA XREF: main+<span class="number">112</span>↑o</span><br><span class="line">.rodata:<span class="number">0000000000400797</span> aC              db <span class="string">&#x27;c&#x27;</span>,<span class="number">0</span>                ; DATA XREF: main+<span class="number">128</span>↑o</span><br><span class="line">.rodata:<span class="number">0000000000400799</span> aD              db <span class="string">&#x27;d&#x27;</span>,<span class="number">0</span>                ; DATA XREF: main+<span class="number">133</span>↑o</span><br><span class="line">.rodata:<span class="number">000000000040079B</span> aE              db <span class="string">&#x27;e&#x27;</span>,<span class="number">0</span>                ; DATA XREF: main+<span class="number">13</span>E↑o</span><br><span class="line">.rodata:<span class="number">000000000040079</span>D asc_40079D      db <span class="string">&#x27;f&#x27;</span>,<span class="number">0</span>                ; DATA XREF: main+<span class="number">149</span>↑o</span><br><span class="line">.rodata:<span class="number">000000000040079F</span> aG              db <span class="string">&#x27;g&#x27;</span>,<span class="number">0</span>                ; DATA XREF: main+<span class="number">154</span>↑o</span><br></pre></td></tr></table></figure>

<h2 id="const-char-f-10-“fffffff”"><a href="#const-char-f-10-“fffffff”" class="headerlink" title="const char f[10]={“fffffff”};"></a>const char f[10]={“fffffff”};</h2><blockquote>
<p>C 语言中 const 关键字是 constant 的缩写，其作用是将变量定义为不可修改的常量变量（得看情况）。</p>
</blockquote>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">.text:<span class="number">00000000004006</span>A2                 mov     rax, <span class="number">66666666666666</span>h</span><br><span class="line">.text:<span class="number">00000000004006</span>AC                 mov     qword ptr [rbp+f], rax</span><br><span class="line">.text:<span class="number">00000000004006B</span>0                 mov     word ptr [rbp+f+<span class="number">8</span>], <span class="number">0</span></span><br></pre></td></tr></table></figure>

<p>写入之后内存如下：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">pwndbg&gt; x/<span class="number">8</span>gx &amp;f</span><br><span class="line"><span class="number">0x7fffffffdde0</span>:	<span class="number">0x0000000000400700</span>	<span class="number">0x0000000000400450</span></span><br><span class="line"><span class="number">0x7fffffffddf0</span>:	<span class="number">0x00007fffffffdee0</span>	<span class="number">0x9fa1dc511b787e00</span></span><br><span class="line"><span class="number">0x7fffffffde00</span>:	<span class="number">0x0000000000400700</span>	<span class="number">0x00007ffff7a2d840</span></span><br><span class="line"><span class="number">0x7fffffffde10</span>:	<span class="number">0x0000000000000001</span>	<span class="number">0x00007fffffffdee8</span></span><br><span class="line">pwndbg&gt;</span><br><span class="line">-------------------------------------------------------------#执行之后：</span><br><span class="line">pwndbg&gt; x/<span class="number">8</span>gx &amp;f</span><br><span class="line"><span class="number">0x7fffffffdde0</span>:	<span class="number">0x0066666666666666</span>	<span class="number">0x0000000000400000</span></span><br><span class="line">    		   #<span class="number">0</span>x????????????????  <span class="number">0</span>x            ????</span><br><span class="line"><span class="number">0x7fffffffddf0</span>:	<span class="number">0x00007fffffffdee0</span>	<span class="number">0x9fa1dc511b787e00</span></span><br><span class="line"><span class="number">0x7fffffffde00</span>:	<span class="number">0x0000000000400700</span>	<span class="number">0x00007ffff7a2d840</span></span><br><span class="line"><span class="number">0x7fffffffde10</span>:	<span class="number">0x0000000000000001</span>	<span class="number">0x00007fffffffdee8</span></span><br><span class="line">pwndbg&gt;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>??代表受影响的内存</p>
</blockquote>
<p>在 gcc 的环境下，虽然我们利用 const 想让变量变为不可修改，但是在这个例子中，加入 const 后变量仍然可读，因为栈内存是可读可写的。</p>
<h2 id="const-char"><a href="#const-char" class="headerlink" title="const char*"></a>const char*</h2><ul>
<li>const char* g=”ggggggg”;</li>
<li>char* const h=”hhhhhhh”;</li>
<li>const char* const i = “iiiiiii”;</li>
</ul>
<p>最后这三个是一样的类型，统一来说一下：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">.text:<span class="number">00000000004006B</span>6                 mov     [rbp+g], offset aGgggggg ; <span class="string">&quot;ggggggg&quot;</span></span><br><span class="line">.text:<span class="number">00000000004006</span>C1                 mov     [rbp+h], offset aHhhhhhh ; <span class="string">&quot;hhhhhhh&quot;</span></span><br><span class="line">.text:<span class="number">00000000004006</span>CC                 mov     [rbp+i], offset aIiiiiii ; <span class="string">&quot;iiiiiii&quot;</span></span><br><span class="line">----------------------------------------------------------------------------------</span><br><span class="line">.rodata:<span class="number">00000000004007</span>A1 aGgggggg        db <span class="string">&#x27;ggggggg&#x27;</span>,<span class="number">0</span>          ; DATA XREF: main+<span class="number">170</span>↑o</span><br><span class="line">.rodata:<span class="number">00000000004007</span>A9 aHhhhhhh        db <span class="string">&#x27;hhhhhhh&#x27;</span>,<span class="number">0</span>          ; DATA XREF: main+<span class="number">17B</span>↑o</span><br><span class="line">.rodata:<span class="number">00000000004007B</span>1 aIiiiiii        db <span class="string">&#x27;iiiiiii&#x27;</span>,<span class="number">0</span>          ; DATA XREF: main+<span class="number">186</span>↑o</span><br></pre></td></tr></table></figure>

<p>执行代码前后：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">pwndbg&gt; x/<span class="number">8</span>gx &amp;g</span><br><span class="line"><span class="number">0x7fffffffdce8</span>:	<span class="number">0x0000000000000000</span>	<span class="number">0x00007ffff7ffea88</span></span><br><span class="line"><span class="number">0x7fffffffdcf8</span>:	<span class="number">0x00007fffffffdd30</span>	<span class="number">0x0000000000000061</span></span><br><span class="line"><span class="number">0x7fffffffdd08</span>:	<span class="number">0x0000000000000062</span>	<span class="number">0x0000000000000063</span></span><br><span class="line"><span class="number">0x7fffffffdd18</span>:	<span class="number">0x0000000000000064</span>	<span class="number">0x0000000000000065</span></span><br><span class="line">------------------------------------------------------------</span><br><span class="line">pwndbg&gt; x/<span class="number">8</span>gx &amp;g</span><br><span class="line"><span class="number">0x7fffffffdce8</span>:	<span class="number">0x00000000004007a1</span>	<span class="number">0x00000000004007a9</span></span><br><span class="line">    			<span class="meta">#g					#h</span></span><br><span class="line"><span class="number">0x7fffffffdcf8</span>:	<span class="number">0x00000000004007b1</span>	<span class="number">0x0000000000000061</span></span><br><span class="line">    			<span class="meta">#i</span></span><br><span class="line"><span class="number">0x7fffffffdd08</span>:	<span class="number">0x0000000000000062</span>	<span class="number">0x0000000000000063</span></span><br><span class="line"><span class="number">0x7fffffffdd18</span>:	<span class="number">0x0000000000000064</span>	<span class="number">0x0000000000000065</span></span><br><span class="line">pwndbg&gt; x/<span class="number">8</span>gx g</span><br><span class="line"><span class="number">0x4007a1</span>:	<span class="number">0x0067676767676767</span>	<span class="number">0x0068686868686868</span></span><br><span class="line"><span class="number">0x4007b1</span>:	<span class="number">0x0069696969696969</span>	<span class="number">0x303b031b01000000</span></span><br><span class="line"><span class="number">0x4007c1</span>:	<span class="number">0x5400000005000000</span>	<span class="number">0x940000007cfffffc</span></span><br><span class="line"><span class="number">0x4007d1</span>:	<span class="number">0x8a0000004cfffffc</span>	<span class="number">0x44000000a4fffffd</span></span><br><span class="line">pwndbg&gt; x/<span class="number">8</span>gx *g</span><br><span class="line"><span class="number">0x67</span>:	Cannot access memory at address <span class="number">0x67</span></span><br><span class="line">pwndbg&gt;</span><br><span class="line">#上面的x/<span class="number">8</span>gx g、x/<span class="number">8</span>gx &amp;g、x/<span class="number">8</span>gx *g都是一样的效果。</span><br></pre></td></tr></table></figure>

<p>写入的数据都是指针，而指针指向的数据是.rodata 段（read only data）,因此指针可以更改（栈空间），而字符串不可更改。</p>
<h1 id="一些补充"><a href="#一些补充" class="headerlink" title="一些补充"></a>一些补充</h1><p><img src="https://cdn.nlark.com/yuque/0/2021/png/574026/1611825888973-89309570-b6ab-4127-b247-822db3608f6e.png#align=left&display=inline&height=540&margin=%5Bobject%20Object%5D&name=image.png&originHeight=540&originWidth=603&size=36500&status=done&style=none&width=603" alt="image.png"></p>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://www.geeksforgeeks.org/whats-difference-between-char-s-and-char-s-in-c/">https://www.geeksforgeeks.org/whats-difference-between-char-s-and-char-s-in-c/</a></p>
</blockquote>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">char</span> str1[<span class="number">20</span>] = &#123;<span class="string">&quot;hello world6666666&quot;</span>&#125;;</span><br><span class="line">	<span class="keyword">const</span> <span class="keyword">char</span> str1[<span class="number">20</span>] = &#123;<span class="string">&quot;hello world6666666&quot;</span>&#125;;</span><br><span class="line">	<span class="comment">//char str2[10] = &#123;&quot;hello&quot;,&quot;world&quot;&#125;; Error 没有这种写法</span></span><br><span class="line">	<span class="comment">//const char str4[10] = &#123;&quot;hello&quot;,&quot;world&quot;&#125;; Error 没有这种写法</span></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.nlark.com/yuque/0/2021/png/574026/1611825929033-ecf637cc-242b-4403-9d26-cc3ca027277e.png#align=left&display=inline&height=628&margin=%5Bobject%20Object%5D&name=image.png&originHeight=628&originWidth=1590&size=272892&status=done&style=none&width=1590" alt="image.png"><br>原本以为之前的 const char f[10]={“fffffff”};中的 const 无效是由于字符串长度不够长，看来不是这样。**</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">Cyberangel</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://cyberangel.cn/2021/01/27/PWN%E6%9D%82%E8%AE%B0%EF%BC%881-2%EF%BC%89-%E3%80%8Agcc%E4%B8%AD%E5%85%B3%E4%BA%8EC%E8%AF%AD%E8%A8%80char%E7%B1%BB%E5%9E%8B%E7%9A%84%E8%BF%99%E4%BB%B6%E4%BA%8B%EF%BC%881%EF%BC%89%E3%80%8B/">https://cyberangel.cn/2021/01/27/PWN杂记（1-2）-《gcc中关于C语言char类型的这件事（1）》/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://cyberangel.cn" target="_blank">Cyberangel-blog</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"></div><div class="post_share"><div class="social-share" data-image="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button button--animated"><i class="fas fa-qrcode"></i> 打赏</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="/img/wechat.jpg" target="_blank"><img class="post-qr-code-img" src="/img/wechat.jpg" alt="wechat"/></a><div class="post-qr-code-desc">wechat</div></li><li class="reward-item"><a href="/img/alipay.jpg" target="_blank"><img class="post-qr-code-img" src="/img/alipay.jpg" alt="alipay"/></a><div class="post-qr-code-desc">alipay</div></li></ul></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2021/02/04/CVE%202021-3156-%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E5%A4%8D%E7%8E%B0sudoedit%E6%8F%90%E6%9D%83%E6%BC%8F%E6%B4%9E%EF%BC%881%EF%BC%89/"><img class="prev-cover" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">CVE 2021-3156-从零开始复现sudoedit提权漏洞（1）</div></div></a></div><div class="next-post pull-right"><a href="/2021/01/25/PWN%E8%BF%9B%E9%98%B6%EF%BC%881-7-1%EF%BC%89-fastbin%E7%9A%84malloc_consolidate%EF%BC%88smallbin%E3%80%81unsortedbin%EF%BC%89%E4%B8%8EFASTBIN_CONSOLIDATION_THRESHOLD/"><img class="next-cover" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">PWN进阶（1-7-1）-fastbin的malloc_consolidate（smallbin、unsortedbin）与FASTBIN_CONSOLIDATION_THRESHOLD</div></div></a></div></nav><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="disqus_thread"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%A0%94%E7%A9%B6%E5%AF%B9%E8%B1%A1"><span class="toc-number">1.</span> <span class="toc-text">研究对象</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%89%8D%E8%A8%80"><span class="toc-number">2.</span> <span class="toc-text">前言</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BB%A3%E7%A0%81%E7%BC%96%E8%AF%91"><span class="toc-number">3.</span> <span class="toc-text">代码编译</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%B0%83%E8%AF%95"><span class="toc-number">4.</span> <span class="toc-text">调试</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%88%86%E6%9E%90"><span class="toc-number">5.</span> <span class="toc-text">分析</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A0%88%E7%A9%BA%E9%97%B4%E5%88%9D%E5%A7%8B%E5%8C%96"><span class="toc-number">5.1.</span> <span class="toc-text">栈空间初始化</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#char-a-10-%E2%80%98a%E2%80%99-%E2%80%99a%E2%80%99-%E2%80%99a%E2%80%99-%E2%80%99a%E2%80%99-%E2%80%99a%E2%80%99-%E2%80%99a%E2%80%99-%E2%80%99a%E2%80%99"><span class="toc-number">5.2.</span> <span class="toc-text">char a[10]&#x3D;{‘a’,’a’,’a’,’a’,’a’,’a’,’a’};</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#char-m-%E2%80%98a%E2%80%99-%E2%80%9Db%E2%80%9D-%E2%80%99c%E2%80%99-%E2%80%99d%E2%80%99-%EF%BC%88ERROR%EF%BC%89"><span class="toc-number">5.3.</span> <span class="toc-text">char m[]&#x3D;{‘a’,”b”,’c’,’d’};（ERROR）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#char-n-%E2%80%98m%E2%80%99-%E2%80%9Dnnnn%E2%80%9D-%E2%80%99o%E2%80%99-%E2%80%99d%E2%80%99-%E2%80%99p%E2%80%99-%E2%80%9Dq%E2%80%9D-%EF%BC%88ERROR%EF%BC%89"><span class="toc-number">5.4.</span> <span class="toc-text">char n[]&#x3D;{‘m’,”nnnn”,’o’,’d’,’p’,”q”};（ERROR）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#char-b-%E2%80%9Dbbbbbbb%E2%80%9D"><span class="toc-number">5.5.</span> <span class="toc-text">char* b&#x3D;”bbbbbbb”;</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#char-c-10-%E2%80%9Dccccccc%E2%80%9D"><span class="toc-number">5.6.</span> <span class="toc-text">char c[10]&#x3D;”ccccccc”;</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#char-d-10-%E2%80%98a%E2%80%99-%E2%80%99b%E2%80%99-%E2%80%99c%E2%80%99-%E2%80%99d%E2%80%99-%E2%80%99e%E2%80%99-%E2%80%99f%E2%80%99-%E2%80%99g%E2%80%99-%EF%BC%88ERROR%EF%BC%89"><span class="toc-number">5.7.</span> <span class="toc-text">char* d[10]&#x3D;{‘a’,’b’,’c’,’d’,’e’,’f’,’g’};（ERROR）</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">6.</span> <span class="toc-text"></span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#char-e-10-%E2%80%9Ca%E2%80%9D-%E2%80%9Db%E2%80%9D-%E2%80%9Dc%E2%80%9D-%E2%80%9Dd%E2%80%9D-%E2%80%9De%E2%80%9D-%E2%80%9Df%E2%80%9D-%E2%80%9Dg%E2%80%9D"><span class="toc-number">6.1.</span> <span class="toc-text">char* e[10]&#x3D;{“a”,”b”,”c”,”d”,”e”,”f”,”g”};</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#const-char-f-10-%E2%80%9Cfffffff%E2%80%9D"><span class="toc-number">6.2.</span> <span class="toc-text">const char f[10]&#x3D;{“fffffff”};</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#const-char"><span class="toc-number">6.3.</span> <span class="toc-text">const char*</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%80%E4%BA%9B%E8%A1%A5%E5%85%85"><span class="toc-number">7.</span> <span class="toc-text">一些补充</span></a></li></ol></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2019 - 2021 By Cyberangel</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">为世界上所有美好而战！！！</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="font-plus" type="button" title="放大字体"><i class="fas fa-plus"></i></button><button id="font-minus" type="button" title="缩小字体"><i class="fas fa-minus"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="chat_btn" type="button" title="rightside.chat_btn"><i class="fas fa-sms"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div></div><hr/><div id="local-search-results"></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="/js/search/local-search.js"></script><div class="js-pjax"><script>function loadDisqus () {
  var disqus_config = function () {
    this.page.url = 'https://cyberangel.cn/2021/01/27/PWN%E6%9D%82%E8%AE%B0%EF%BC%881-2%EF%BC%89-%E3%80%8Agcc%E4%B8%AD%E5%85%B3%E4%BA%8EC%E8%AF%AD%E8%A8%80char%E7%B1%BB%E5%9E%8B%E7%9A%84%E8%BF%99%E4%BB%B6%E4%BA%8B%EF%BC%881%EF%BC%89%E3%80%8B/'
    this.page.identifier = '2021/01/27/PWN杂记（1-2）-《gcc中关于C语言char类型的这件事（1）》/'
    this.page.title = 'PWN杂记（1-2）-《gcc中关于C语言char类型的这件事（1）》'
  };

  window.disqusReset = () => {
    DISQUS.reset({
      reload: true,
      config: disqus_config
    })
  }

  if (window.DISQUS) disqusReset()
  else {
    (function() { 
      var d = document, s = d.createElement('script');
      s.src = 'https://.disqus.com/embed.js';
      s.setAttribute('data-timestamp', +new Date());
      (d.head || d.body).appendChild(s);
    })();
  }
}

if ('Disqus' === 'Disqus' || !false) {
  if (false) btf.loadComment(document.getElementById('disqus_thread'), loadDisqus)
  else loadDisqus()
} else {
  function loadOtherComment () {
    loadDisqus()
  }
}
</script><script>if (window.DISQUSWIDGETS === undefined) {
  var d = document, s = d.createElement('script');
  s.src = 'https://.disqus.com/count.js';
  s.id = 'dsq-count-scr';
  (d.head || d.body).appendChild(s);
} else {
  DISQUSWIDGETS.getCount({reset: true});
}</script></div><canvas class="fireworks" mobile="true"></canvas><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/fireworks.min.js"></script><script defer="defer" id="ribbon" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-ribbon.min.js" size="150" alpha="0.6" zIndex="-1" mobile="false" data-click="false"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = true;
POWERMODE.mobile = true;
document.body.addEventListener('input', POWERMODE);
</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>